(()=>{var e={};e.id=664,e.ids=[664],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},9502:(e,t,s)=>{"use strict";s.r(t),s.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,originalPathname:()=>x,pages:()=>d,routeModule:()=>m,tree:()=>c}),s(1235),s(3169),s(5866);var a=s(3191),i=s(8716),r=s(7922),n=s.n(r),l=s(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);s.d(t,o);let c=["",{children:["square",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,1235)),"/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/square/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,3169)),"/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/square/page.tsx"],x="/square/page",u={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:i.x.APP_PAGE,page:"/square/page",pathname:"/square",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},3660:(e,t,s)=>{Promise.resolve().then(s.bind(s,3829))},3829:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>w});var a=s(326),i=s(772);let r=(0,s(2881).Z)("file-x",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m14.5 12.5-5 5",key:"b62r18"}],["path",{d:"m9.5 12.5 5 5",key:"1rk7el"}]]);var n=s(7636),l=s(6015),o=s(7427),c=s(5558),d=s(3211),x=s(3136),u=s(6968),m=s(3723),h=s(7577),p=s(5047),g=s(2991),f=s(6824),j=s(7402),y=s(5792),b=s(7912),v=s(6226);function w(){let{t:e}=(0,d.Z)(),{authInfo:t,isAuthenticated:s}=(0,x.a)(),w=(0,p.useRouter)();(0,p.useSearchParams)();let[k,N]=(0,h.useState)("recommend"),[C,$]=(0,h.useState)([]),[q,I]=(0,h.useState)(!1),[L,S]=(0,h.useState)(""),[F,P]=(0,h.useState)(""),[T,Z]=(0,h.useState)(""),[E,_]=(0,h.useState)(!1),[z,M]=(0,h.useState)(null),[D,A]=(0,h.useState)({}),[B,U]=(0,h.useState)(!1),[R,G]=(0,h.useState)(null),[O,H]=(0,h.useState)(!1),[V,W]=(0,h.useState)(null),[K,X]=(0,h.useState)([]),[Q,J]=(0,h.useState)(0),Y=(0,h.useCallback)(async()=>{_(!0);try{let e=await (0,b.gI)();if("denied"===e)return console.warn("用户拒绝了地理位置权限"),P(""),"";let t=await (0,b.g_)();return P(t),t}catch(e){return console.warn("获取地理位置失败:",e),P(""),""}finally{_(!1)}},[]),ee=(0,h.useCallback)(async(s,a)=>{I(!0),S("");try{let i=a||k,r="";r=s||("nearby"===i?F||"":T||"");let n="recommend"!==i||t?.userId&&t?.token,l=await (0,g.SX)({userId:n&&t?.userId||"",token:n&&t?.token||"",location:r,tab:i,page:1,limit:999});if(l.success&&l.data){let e=l.data.posts||[];$(e),M(l.data.pagination||null);let t={};e.forEach(e=>{t[e.id]={isLove:!0===e.isLove||1===e.isLove,isCollect:!0===e.isCollect||1===e.isCollect,likes:e.likes||0,bookmarks:e.collects||0,isInteracting:!1}}),A(t)}else S(e("square.loadDetailFailed"))}catch(t){S(e("square.loadDetailError"))}finally{I(!1)}},[t,F,T,k,w,e]),et=e=>{t?.userId&&t?.token?w.push(`/square/${e}?userId=${t.userId}&token=${t.token}`):w.push(`/square/${e}`)},es=async(a,i)=>{if(i.stopPropagation(),!t?.userId||!t?.token||!s){w.push("/login");return}let r=D[a];if(!r?.isInteracting){A(e=>({...e,[a]:{...e[a],isInteracting:!0}}));try{(await (0,g.v1)({userId:t.userId,token:t.token,productId:a,isLove:r?.isLove?0:1})).success?A(e=>({...e,[a]:{...e[a],isLove:!e[a]?.isLove,likes:(e[a]?.likes||0)+(e[a]?.isLove?-1:1),isInteracting:!1}})):alert(e("square.operationFailed"))}catch(t){console.error("点赞失败:",t),alert(e("square.operationFailed"))}finally{A(e=>({...e,[a]:{...e[a],isInteracting:!1}}))}}},ea=async(a,i)=>{if(i.stopPropagation(),!t?.userId||!t?.token||!s){w.push("/login");return}let r=D[a];if(!r?.isInteracting){A(e=>({...e,[a]:{...e[a],isInteracting:!0}}));try{(await (0,g.gQ)({userId:t.userId,token:t.token,productId:a,isCollect:r?.isCollect?0:1})).success?A(e=>({...e,[a]:{...e[a],isCollect:!e[a]?.isCollect,bookmarks:(e[a]?.bookmarks||0)+(e[a]?.isCollect?-1:1),isInteracting:!1}})):alert(e("square.operationFailed"))}catch(t){console.error("收藏失败:",t),alert(e("square.operationFailed"))}finally{A(e=>({...e,[a]:{...e[a],isInteracting:!1}}))}}},ei=e=>{G(e),U(!0)},er=()=>{U(!1),G(null)},en=(e,t,s)=>{X(t),J(s),W(e),H(!0)},el=()=>{H(!1),W(null),X([]),J(0)},eo=()=>{if(Q>0){let e=Q-1;J(e),W(K[e])}},ec=()=>{if(Q<K.length-1){let e=Q+1;J(e),W(K[e])}},ed=async(s,a)=>{if(a.stopPropagation(),t?.userId&&t?.token)try{await (0,g._Z)({userId:t.userId,token:t.token,productId:s.id}),$(e=>e.map(e=>e.id===s.id?{...e,shares:(e.shares||0)+1}:e))}catch(e){console.error("分享接口调用失败:",e)}try{navigator.share?await navigator.share({title:s.title||"Untitled",text:s.description||"",url:`${window.location.origin}/square/${s.id}`}):(await navigator.clipboard.writeText(`${window.location.origin}/square/${s.id}`),alert(e("square.linkCopied")))}catch(e){"AbortError"!==e.name&&console.error("分享失败:",e)}};return(0,a.jsxs)("div",{className:"min-h-screen bg-white",children:[a.jsx("svg",{className:"absolute w-0 h-0",children:(0,a.jsxs)("defs",{children:[(0,a.jsxs)("linearGradient",{id:"bookmark-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[a.jsx("stop",{offset:"0%",stopColor:"#eab308"}),a.jsx("stop",{offset:"100%",stopColor:"#f97316"})]}),(0,a.jsxs)("linearGradient",{id:"heart-gradient",x1:"0%",y1:"0%",x2:"100%",y2:"0%",children:[a.jsx("stop",{offset:"0%",stopColor:"#FD9507"}),a.jsx("stop",{offset:"100%",stopColor:"#CE14B0"})]})]})}),(0,a.jsxs)("main",{className:" flex min-h-[100vh] flex-col",children:[a.jsx(u.h,{showSearch:!0,showUser:!0,userLink:"/personal-center"}),(0,a.jsxs)("div",{className:"flex items-center justify-between px-2 pt-3 pb-2  z-100",children:[(0,a.jsxs)("div",{className:"flex space-x-2",children:[a.jsx("button",{onClick:()=>{let e="recommend";N(e),ee("",e)},className:`text-sm  px-3 py-1 rounded-full transition-all font-poppins ${"recommend"===k?"w-36 h-7 bg-gradient-to-r from-[#FD9507] to-[#CE14B0] text-white shadow-sm font-semibold":"font-semibold text-[#0F1728] hover:text-gray-800"}`,children:e("square.recommend")}),a.jsx("button",{onClick:()=>{if(!t?.userId||!t?.token){w.push("/login");return}let e="following";N(e),ee("",e)},className:`text-sm  px-3 py-1 rounded-full transition-all font-poppins ${"following"===k?"w-36 h-7 bg-gradient-to-r from-[#FD9507] to-[#CE14B0] text-white shadow-sm font-semibold":"font-semibold text-[#0F1728] hover:text-gray-800"}`,children:e("square.following")}),a.jsx("button",{onClick:async()=>{if(!t?.userId||!t?.token){w.push("/login");return}let e="nearby";N(e),ee(await Y(),e)},className:`text-sm font-medium px-3 py-1 rounded-full transition-all font-poppins ${"nearby"===k?"w-36 h-7 bg-gradient-to-r from-[#FD9507] to-[#CE14B0] text-white shadow-sm font-semibold":"font-semibold text-[#0F1728] hover:text-gray-800"}`,children:e("square.nearby")})]}),a.jsx("div",{className:"flex items-center",children:a.jsx(i.z,{variant:"ghost",size:"sm",onClick:()=>w.push(`/region-select?from=square&filterLocation=${T}`),className:"text-gray-600 hover:text-gray-800 py-1",children:a.jsx(v.default,{src:"/img/Filter.png",alt:"Filter",width:16,height:16,className:"w-6 h-6"})})})]}),(q||E)&&a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx(j.TK,{size:"lg",text:E?e("square.gettingLocation"):e("square.loading")})}),L&&!q&&!E&&a.jsx("div",{className:"flex-1 flex items-center justify-center",children:a.jsx(j.Te,{error:L,onRetry:()=>s&&ee(F)})}),!q&&!L&&!E&&0===C.length&&(0,a.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center px-4 py-12",children:[a.jsx(r,{className:"h-16 w-16 text-gray-300 mb-4"}),a.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:e("square.noContent")}),a.jsx("p",{className:"text-sm text-gray-500 text-center max-w-sm",children:"recommend"===k?e("square.noRecommendContent"):s?e("square.noNearbyContent"):e("square.loginRequired")})]}),!q&&!L&&!E&&C.length>0&&(0,a.jsxs)("div",{className:"flex-1 ",children:[a.jsx("div",{className:"space-y-0",children:C.map((t,i)=>(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"bg-white px-4 pt-2 cursor-pointer hover:shadow-sm transition-shadow",onClick:()=>et(t.id),children:[a.jsx("div",{className:"flex items-center gap-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[a.jsx("img",{src:`${f.bl.STATIC_URL}${t.publisher.avatar}`,alt:t.publisher.nickname,className:"w-9 h-9 object-cover rounded-full"}),a.jsx("span",{className:"text-sm text-[#0F1728] leading-9 font-nunito",children:t.publisher.nickname})]})}),a.jsx("h3",{className:" text-[#12295B] text-[17px] italic leading-[34px] font-nunito font-semibold",children:t.title}),a.jsx("p",{className:"text-sm text-[#20313B]  leading-[17px] font-inter",children:t.description}),(0,a.jsxs)("div",{className:"flex gap-2 overflow-x-auto my-2",children:[t.video&&(0,a.jsxs)("div",{className:"relative w-34 h-24 rounded flex-shrink-0 bg-gray-200 overflow-hidden cursor-pointer",onClick:e=>{e.stopPropagation(),ei(`${f.bl.STATIC_URL}${t.video}`)},children:[a.jsx("video",{src:`${f.bl.STATIC_URL}${t.video}`,className:"w-full h-full object-cover",muted:!0,preload:"metadata",onLoadedMetadata:e=>{e.currentTarget.currentTime=.1}}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-opacity-30",children:a.jsx("div",{className:"w-8 h-8 bg-white bg-opacity-90 rounded-full flex items-center justify-center",children:a.jsx("svg",{className:"w-4 h-4 text-gray-800 ml-0.5",fill:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{d:"M8 5v14l11-7z"})})})})]}),t.images.map((e,s)=>{let i=`${f.bl.STATIC_URL}${e}`,r=t.images.map(e=>`${f.bl.STATIC_URL}${e}`);return a.jsx("div",{className:"relative w-36 h-24 rounded flex-shrink-0 bg-gray-100 overflow-hidden cursor-pointer",onClick:e=>{e.stopPropagation(),en(i,r,s)},children:a.jsx(y.d,{src:i,alt:`Post ${t.id} image ${s+1}`,className:"w-full h-full object-cover"})},s)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between my-2",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-1",children:[t.updatedAt&&a.jsx("span",{className:"text-xs text-gray-500",children:t.updatedAt}),(0,a.jsxs)("div",{className:"flex items-center gap-2 mt-2",children:[a.jsx(n.Z,{className:"h-4 w-4 text-[#0F1728] font-semibold"}),a.jsx("span",{className:"text-sm text-gray-500",children:t.location})]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,a.jsxs)("button",{onClick:e=>ea(t.id,e),disabled:!s||D[t.id]?.isInteracting,className:`flex flex-col items-center gap-0.5 transition-colors ${D[t.id]?.isCollect?"bg-gradient-to-r from-yellow-500 to-orange-500 bg-clip-text text-transparent":"text-[#0F1728] hover:text-gray-700"} ${!s||D[t.id]?.isInteracting?"opacity-50 cursor-not-allowed":""}`,title:s?"":e("square.pleaseLoginFirst"),children:[a.jsx(l.Z,{className:"h-6 w-6 font-semibold",style:D[t.id]?.isCollect?{fill:"url(#bookmark-gradient)"}:{}}),a.jsx("span",{className:`text-xs font-nunito ${D[t.id]?.isCollect?"bg-gradient-to-r from-yellow-500 to-orange-500 bg-clip-text text-transparent":""}`,children:D[t.id]?.bookmarks||t.collects||0})]}),(0,a.jsxs)("button",{onClick:e=>es(t.id,e),disabled:!s||D[t.id]?.isInteracting,className:`flex flex-col items-center gap-0.5 transition-colors ${D[t.id]?.isLove?"bg-gradient-to-r from-[#FD9507] to-[#CE14B0] bg-clip-text text-transparent":"text-[#0F1728] hover:text-red-500"} ${!s||D[t.id]?.isInteracting?"opacity-50 cursor-not-allowed":""}`,title:s?"":e("square.pleaseLoginFirst"),children:[a.jsx(o.Z,{className:"h-6 w-6 font-semibold",style:D[t.id]?.isLove?{fill:"url(#heart-gradient)"}:{}}),a.jsx("span",{className:`text-xs font-nunito ${D[t.id]?.isLove?"bg-gradient-to-r from-[#FD9507] to-[#CE14B0] bg-clip-text text-transparent":""}`,children:D[t.id]?.likes||t.likes||0})]}),(0,a.jsxs)("button",{onClick:e=>ed(t,e),className:"flex flex-col items-center gap-0.5 text-[#0F1728] hover:text-gray-700 transition-colors",children:[a.jsx(c.Z,{className:"h-6 w-6 font-semibold"}),a.jsx("span",{className:"text-xs font-nunito",children:t.shares||e("square.share")})]})]})]})]}),i<C.length-1&&a.jsx("div",{className:"mx-4 my-4",style:{borderBottom:"1px solid #e5e7eb"}})]},t.id))}),z&&a.jsx("div",{className:"px-4 py-3 text-center text-xs text-gray-500",children:e("square.pagination").replace("{items}",z.totalItems.toString())})]}),a.jsx(m.$,{}),B&&R&&a.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center z-200",children:(0,a.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[a.jsx("button",{onClick:er,className:"absolute top-4 right-4 z-10 w-10 h-10 bg-black bg-opacity-50 text-white rounded-full flex items-center justify-center hover:bg-opacity-70 transition-all",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),a.jsx("video",{src:R,className:"max-w-full max-h-full object-contain",controls:!0,autoPlay:!0,onEnded:er,onError:e=>{console.error("视频播放失败:",e),er()}})]})}),O&&V&&a.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-90 flex items-center justify-center z-200",onClick:el,children:(0,a.jsxs)("div",{className:"relative w-full h-full flex items-center justify-center",children:[a.jsx("button",{onClick:el,className:"absolute top-4 right-4 z-10 w-10 h-10 bg-black bg-opacity-50 text-white rounded-full flex items-center justify-center hover:bg-opacity-70 transition-all",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),Q>0&&a.jsx("button",{onClick:e=>{e.stopPropagation(),eo()},className:"absolute left-4 z-10 w-10 h-10 bg-black bg-opacity-50 text-white rounded-full flex items-center justify-center hover:bg-opacity-70 transition-all",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})})}),Q<K.length-1&&a.jsx("button",{onClick:e=>{e.stopPropagation(),ec()},className:"absolute right-4 z-10 w-10 h-10 bg-black bg-opacity-50 text-white rounded-full flex items-center justify-center hover:bg-opacity-70 transition-all",children:a.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})}),a.jsx("div",{className:"max-w-full max-h-full flex items-center justify-center px-16",onClick:e=>e.stopPropagation(),children:a.jsx("img",{src:V,alt:"Preview",className:"max-w-full max-h-full object-contain"})}),K.length>1&&(0,a.jsxs)("div",{className:"absolute bottom-4 left-1/2 transform -translate-x-1/2 z-10 bg-black bg-opacity-50 text-white px-4 py-2 rounded-full text-sm",children:[Q+1," / ",K.length]})]})})]})]})}},3723:(e,t,s)=>{"use strict";s.d(t,{$:()=>o});var a=s(326),i=s(3211),r=s(6226);function n({transparent:e=!1}){let{language:t,setLanguage:s}=(0,i.Z)();return(0,a.jsxs)("button",{onClick:()=>{s("en"===t?"zh":"en")},className:`flex items-center ${e?"text-white":"text-[#0F1728]"} hover:opacity-80 transition-opacity`,"aria-label":`Switch to ${"en"===t?"Chinese":"English"}`,children:[a.jsx(r.default,{src:e?"/img/lang.png":"/img/lang-d.png",alt:"Language",width:24,height:24,className:"h-4 w-4"}),a.jsx("span",{className:`text-[10px] font-medium ml-1 ${e?"text-white":"text-[#0F1728]"}`,children:"en"===t?"EN":"CN"})]})}var l=s(434);function o({transparent:e=!1}){let{t}=(0,i.Z)();return a.jsx("footer",{className:`mt-auto text-[10px] py-4 px-4 w-full font-inter ${e?"text-white":"text-[#0F1728]"}`,children:(0,a.jsxs)("div",{className:"flex justify-between items-center w-full",children:[a.jsx("div",{className:"flex items-center gap-2 font-inter",children:a.jsx(n,{transparent:e})}),(0,a.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[a.jsx(l.default,{href:"/about",className:`${e?"text-white":"text-[#0F1728]"} font-inter`,children:t("footer.links.about")}),a.jsx(l.default,{href:"/privacy",className:`${e?"text-white":"text-[#0F1728]"} font-inter`,children:t("footer.links.privacy")}),a.jsx("span",{className:`${e?"text-white":"text-[#0F1728]"} font-inter`,children:t("footer.copyright")}),a.jsx(r.default,{src:e?"/img/logo-1.png":"/img/logo-2.png",alt:"Language",width:52,height:22,className:"h-5 w-auto"})]})]})})}},7402:(e,t,s)=>{"use strict";s.d(t,{TK:()=>o,Te:()=>c,ub:()=>d});var a=s(326),i=s(772),r=s(1291),n=s(1405),l=s(3211);function o({size:e="md",text:t,className:s=""}){let{t:i}=(0,l.Z)(),r=t||i("common.loading");return(0,a.jsxs)("div",{className:`flex flex-col items-center justify-center ${s}`,children:[a.jsx("div",{className:`animate-spin rounded-full border-b-2 border-[#11295b] ${{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[e]} mb-2`}),r&&a.jsx("p",{className:"text-gray-500 text-sm",children:r})]})}function c({error:e,onRetry:t,retryText:s,className:o=""}){let{t:c}=(0,l.Z)(),d=s||c("common.retry");return(0,a.jsxs)("div",{className:`flex flex-col items-center justify-center ${o}`,children:[a.jsx(r.Z,{className:"h-8 w-8 text-red-500 mb-2"}),a.jsx("p",{className:"text-red-500 mb-4 text-center",children:e}),t&&(0,a.jsxs)(i.z,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[a.jsx(n.Z,{className:"h-4 w-4"}),d]})]})}function d({title:e,description:t,icon:s,action:i,className:r=""}){return(0,a.jsxs)("div",{className:`flex flex-col items-center justify-center text-center ${r}`,children:[s&&a.jsx("div",{className:"mb-4",children:s}),a.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e}),t&&a.jsx("p",{className:"text-gray-500 mb-4",children:t}),i&&a.jsx("div",{children:i})]})}},5792:(e,t,s)=>{"use strict";s.d(t,{d:()=>n});var a=s(326),i=s(7577);let r=(0,s(2881).Z)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);function n({src:e,alt:t,className:s="",fallbackSrc:n="/img/band.png",loading:l="lazy",onError:o,onLoad:c}){let[d,x]=(0,i.useState)(!1),[u,m]=(0,i.useState)(!0);return d?a.jsx("div",{className:`bg-gray-200 flex items-center justify-center ${s}`,children:a.jsx(r,{className:"h-8 w-8 text-gray-400"})}):(0,a.jsxs)("div",{className:`relative ${s}`,children:[u&&a.jsx("div",{className:"absolute inset-0 bg-gray-200 animate-pulse flex items-center justify-center",children:a.jsx(r,{className:"h-8 w-8 text-gray-400"})}),a.jsx("img",{src:e,alt:t,className:`${s} ${u?"opacity-0":"opacity-100"} transition-opacity duration-300`,loading:l,onError:()=>{x(!0),m(!1),o?.()},onLoad:()=>{m(!1),c?.()}})]})}},7912:(e,t,s)=>{"use strict";async function a(e,t){try{if("geolocation"in navigator&&"reverseGeocode"in navigator)throw Error("浏览器不支持反向地理编码");let s=await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${e}&longitude=${t}&localityLanguage=zh`);if(!s.ok)throw Error("地理编码服务不可用");let a=await s.json(),i=[];return a.locality&&i.push(a.locality),a.principalSubdivision&&i.push(a.principalSubdivision),a.countryName&&i.push(a.countryName),i.join("，")||`${e.toFixed(4)}, ${t.toFixed(4)}`}catch(s){return`${e.toFixed(4)}, ${t.toFixed(4)}`}}async function i(e){try{let t=await function(e={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5}){return new Promise((t,s)=>{if(!navigator.geolocation){s({code:-1,message:"浏览器不支持地理位置功能"});return}navigator.geolocation.getCurrentPosition(e=>{t({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy})},e=>{let t="获取地理位置失败";switch(e.code){case e.PERMISSION_DENIED:t="用户拒绝了地理位置请求";break;case e.POSITION_UNAVAILABLE:t="地理位置信息不可用";break;case e.TIMEOUT:t="获取地理位置超时";break;default:t="获取地理位置时发生未知错误"}s({code:e.code,message:t})},e)})}(e);return await a(t.latitude,t.longitude)}catch(e){return console.warn("获取地理位置失败，使用默认位置:",e),"中国，北京"}}async function r(){if(!navigator.permissions)return"prompt";try{return(await navigator.permissions.query({name:"geolocation"})).state}catch(e){return"prompt"}}s.d(t,{gI:()=>r,g_:()=>i})},6015:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("bookmark",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v16z",key:"1fy3hk"}]])},1291:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7427:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("heart",[["path",{d:"M2 9.5a5.5 5.5 0 0 1 9.591-3.676.56.56 0 0 0 .818 0A5.49 5.49 0 0 1 22 9.5c0 2.29-1.5 4-3 5.5l-5.492 5.313a2 2 0 0 1-3 .019L5 15c-1.5-1.5-3-3.2-3-5.5",key:"mvr1a0"}]])},7636:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},1405:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},5558:(e,t,s)=>{"use strict";s.d(t,{Z:()=>a});let a=(0,s(2881).Z)("square-arrow-out-up-right",[["path",{d:"M21 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h6",key:"y09zxi"}],["path",{d:"m21 3-9 9",key:"mpx6sq"}],["path",{d:"M15 3h6v6",key:"1q9fwt"}]])},1235:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>a});let a=(0,s(8570).createProxy)(String.raw`/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/square/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),a=t.X(0,[898,728,591,951],()=>s(9502));module.exports=a})();