(()=>{var e={};e.id=560,e.ids=[560],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},2836:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>g,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c}),a(4255),a(3169),a(5866);var r=a(3191),s=a(8716),i=a(7922),n=a.n(i),l=a(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let c=["",{children:["brand-edit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4255)),"/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/brand-edit/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3169)),"/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/brand-edit/page.tsx"],u="/brand-edit/page",g={require:a,loadChunk:()=>Promise.resolve()},x=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/brand-edit/page",pathname:"/brand-edit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},1508:(e,t,a)=>{Promise.resolve().then(a.bind(a,2910))},2910:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var r=a(326),s=a(772),i=a(1890),n=a(1896),l=a(7636),o=a(3211),c=a(6968),d=a(3723),u=a(5047),g=a(7577),x=a(3136),m=a(6370),p=a(2991),h=a(7912),f=a(6824);function b(){let{t:e}=(0,o.Z)(),t=(0,u.useRouter)(),{getEmail:a}=(0,x.a)(),{userParams:b}=(0,x.z)(),[y,j]=(0,g.useState)({brand:"",brief:"",logo:"",officialsite:"",tel:"",address:"",location:"",workHour:"",email:"",shopurl:""}),[v,w]=(0,g.useState)(!1),[N,P]=(0,g.useState)(null),[E,k]=(0,g.useState)(!1),[S,Z]=(0,g.useState)(null),[C,F]=(0,g.useState)(""),[$,T]=(0,g.useState)(!1),[_,D]=(0,g.useState)(!0),[q,z]=(0,g.useState)(!1),A=(0,g.useRef)(null);(0,g.useRef)(!1);let I=(0,g.useCallback)(async()=>{z(!0),P(null);try{let e=await (0,h.g_)({enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5});j(t=>({...t,location:e}))}catch(a){console.error("获取位置失败:",a);let t=e("brandEditPage.locationFailed");if(a&&"object"==typeof a&&"code"in a)switch(a.code){case 1:t=e("brandEditPage.locationPermissionDenied");break;case 2:t=e("brandEditPage.locationUnavailable");break;case 3:t=e("brandEditPage.locationTimeout");break;case -1:t=e("brandEditPage.locationError")}P(t)}finally{z(!1)}},[e]),L=(e,t)=>{j(a=>({...a,[e]:t}))},M=async t=>{let a=t.target.files?.[0];if(a){if(!a.type.startsWith("image/")){P(e("brandEditPage.invalidImageType"));return}if(a.size>10485760){P(e("brandEditPage.imageTooLarge"));return}Z(a),T(!0),P(null);try{let t=new FileReader;t.onload=e=>{F(e.target?.result)},t.readAsDataURL(a);let r=await (0,p.gg)(a);if(r.success&&r.data){let t="string"==typeof r.data?r.data:r.data.img;if(t&&(t.startsWith("/err")||t.includes("error")))throw Error(e("brandEditPage.imageFormatNotSupported"));t&&(j(e=>({...e,logo:t})),F((0,f.nJ)(t)))}else throw Error(r.message||e("brandEditPage.logoUploadFailed"))}catch(t){console.error("Logo upload failed:",t),P(t instanceof Error?t.message:e("brandEditPage.logoUploadFailed")),Z(null),F("")}finally{T(!1)}}},U=async()=>{if(!a()){P(e("brandEditPage.loginRequired")||"");return}if(!y.brand.trim()){P(e("brandEditPage.brandRequired")||"");return}w(!0),P(null);try{if(!b){P(e("brandEditPage.authInfoMissing")||"");return}let a=await (0,p.I)({userId:b.userId,token:b.token,brand:y.brand,brief:y.brief,logo:y.logo,officialsite:y.officialsite,tel:y.tel,address:y.address,location:y.location,workHour:y.workHour,email:y.email,shopurl:y.shopurl});a.success?(k(!0),setTimeout(()=>{t.push("/personal")},2e3)):P(a.message||e("brandEditPage.submitError")||"")}catch(t){P(t instanceof Error?t.message:e("brandEditPage.submitError")||"")}finally{w(!1)}};return r.jsx(m.a,{children:(0,r.jsxs)("main",{className:"flex min-h-dvh flex-col bg-white",children:[r.jsx(c.h,{}),(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 z-100",children:[r.jsx("h1",{className:"text-xl font-poppins text-[#0F1728] font-semibold",children:e("brandEditPage.title")}),r.jsx("button",{onClick:()=>t.push("/personal"),className:"text-[#0F1728] hover:text-[#0F1728]",children:r.jsx(i.Z,{className:"h-7 w-7 z-10"})})]}),_?r.jsx("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#11295b] mx-auto mb-4"}),r.jsx("p",{className:"text-gray-500",children:e("brandEditPage.loading")})]})}):(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),U()},className:"flex-1 px-6 py-4 space-y-6",children:[r.jsx("div",{children:r.jsx("input",{type:"text",placeholder:e("brandEditPage.brand"),value:y.brand,onChange:e=>L("brand",e.target.value),className:"w-full rounded-full bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60",required:!0})}),r.jsx("div",{children:r.jsx("textarea",{placeholder:e("brandEditPage.brief"),value:y.brief,onChange:e=>L("brief",e.target.value),rows:4,className:"w-full rounded-lg bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),(0,r.jsxs)("div",{className:"flex flex-col items-start",children:[(0,r.jsxs)("label",{className:`w-20 h-20 flex flex-col items-center justify-center rounded-xl bg-gray-200 cursor-pointer relative overflow-hidden ${$?"opacity-50 pointer-events-none":""}`,children:[r.jsx("input",{ref:A,type:"file",accept:"image/*",onChange:M,className:"hidden",disabled:$}),C?(0,r.jsxs)("div",{className:"w-full h-full relative",children:[r.jsx("img",{src:C,alt:"Logo preview",className:"w-full h-full object-cover rounded-xl"}),$&&r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:r.jsx("div",{className:"text-white text-xs",children:e("brandEditPage.uploading")})})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[r.jsx(n.Z,{className:"h-8 w-8 text-gray-400 mt-2"}),r.jsx("span",{className:"block mt-2 text-gray-500 text-sm font-normal",children:$?e("brandEditPage.uploading"):e("brandEditPage.logo")})]})]}),S&&!$&&y.logo&&r.jsx("div",{className:"mt-2 text-xs text-green-600",children:e("brandEditPage.logoUploaded")})]}),r.jsx("div",{children:r.jsx("input",{type:"text",placeholder:e("brandEditPage.officialSite"),value:y.officialsite,onChange:e=>L("officialsite",e.target.value),className:"w-full rounded-full bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),r.jsx("div",{children:r.jsx("input",{type:"text",placeholder:e("releasePage.shopUrl")||"Online shop",value:y.shopurl,onChange:e=>L("shopurl",e.target.value),className:"w-full rounded-full bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),r.jsx("div",{children:r.jsx("input",{type:"tel",placeholder:e("brandEditPage.telMobile"),value:y.tel,onChange:e=>L("tel",e.target.value),className:"w-full rounded-full bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),r.jsx("div",{children:r.jsx("textarea",{placeholder:e("brandEditPage.workHour"),value:y.workHour,onChange:e=>L("workHour",e.target.value),rows:3,className:"w-full rounded-lg bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),r.jsx("div",{children:r.jsx("textarea",{placeholder:e("brandEditPage.email"),value:y.email,onChange:e=>L("email",e.target.value),rows:3,className:"w-full rounded-lg bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),r.jsx("div",{children:r.jsx("textarea",{placeholder:e("brandEditPage.address"),value:y.address,onChange:e=>L("address",e.target.value),rows:3,className:"w-full rounded-lg bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[r.jsx(l.Z,{className:"h-4 w-4"}),(0,r.jsxs)("span",{children:[e("brandEditPage.location"),": ",y.location||e("brandEditPage.gettingLocation")]})]}),!q&&!y.location&&(0,r.jsxs)("button",{type:"button",onClick:I,className:"text-sm text-blue-500 hover:text-blue-700 flex items-center gap-1",children:[r.jsx(l.Z,{className:"h-3 w-3"}),e("brandEditPage.getCurrentLocation")]}),q&&(0,r.jsxs)("div",{className:"flex items-center gap-1 text-sm text-blue-500",children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"}),e("brandEditPage.gettingLocation")]})]}),N&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[r.jsx("div",{className:"h-2 w-2 rounded-full bg-red-500"}),r.jsx("span",{children:N})]}),E&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-500 text-sm",children:[r.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),r.jsx("span",{children:e("brandEditPage.submitSuccess")})]}),r.jsx(s.z,{type:"submit",className:"w-full bg-[#11295b] text-white shadow-md rounded-lg",size:"lg",disabled:v||!!E,children:v?e("brandEditPage.submitting"):e("brandEditPage.submit")})]}),r.jsx("div",{className:"mt-auto",children:r.jsx(d.$,{})})]})})}},6370:(e,t,a)=>{"use strict";a.d(t,{a:()=>d});var r=a(326),s=a(7577),i=a(5047),n=a(3136),l=a(3211),o=a(7402);let c=["/","/square","/login","/register","/forgot-password","/change-password","/personalization","/about","/privacy"];function d({children:e,fallback:t}){let{isAuthenticated:a,authInfo:d}=(0,n.a)(),{t:u}=(0,l.Z)();(0,i.useRouter)();let g=(0,i.usePathname)(),[x,m]=(0,s.useState)(!1);return c.some(e=>"/"===e?"/"===g:g.startsWith(e))?r.jsx(r.Fragment,{children:e}):a&&d?.userId&&d?.token?r.jsx(r.Fragment,{children:e}):t||r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:r.jsx("div",{className:"text-center",children:r.jsx(o.TK,{size:"lg",text:u("common.verifying")})})})}},3723:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var r=a(326),s=a(3211),i=a(6226);function n({transparent:e=!1}){let{language:t,setLanguage:a}=(0,s.Z)();return(0,r.jsxs)("button",{onClick:()=>{a("en"===t?"zh":"en")},className:`flex items-center ${e?"text-white":"text-[#0F1728]"} hover:opacity-80 transition-opacity`,"aria-label":`Switch to ${"en"===t?"Chinese":"English"}`,children:[r.jsx(i.default,{src:e?"/img/lang.png":"/img/lang-d.png",alt:"Language",width:24,height:24,className:"h-4 w-4"}),r.jsx("span",{className:`text-[10px] font-medium ml-1 ${e?"text-white":"text-[#0F1728]"}`,children:"en"===t?"EN":"CN"})]})}var l=a(434);function o({transparent:e=!1}){let{t}=(0,s.Z)();return r.jsx("footer",{className:`mt-auto text-[10px] py-4 px-4 w-full font-inter ${e?"text-white":"text-[#0F1728]"}`,children:(0,r.jsxs)("div",{className:"flex justify-between items-center w-full",children:[r.jsx("div",{className:"flex items-center gap-2 font-inter",children:r.jsx(n,{transparent:e})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[r.jsx(l.default,{href:"/about",className:`${e?"text-white":"text-[#0F1728]"} font-inter`,children:t("footer.links.about")}),r.jsx(l.default,{href:"/privacy",className:`${e?"text-white":"text-[#0F1728]"} font-inter`,children:t("footer.links.privacy")}),r.jsx("span",{className:`${e?"text-white":"text-[#0F1728]"} font-inter`,children:t("footer.copyright")}),r.jsx(i.default,{src:e?"/img/logo-1.png":"/img/logo-2.png",alt:"Language",width:52,height:22,className:"h-5 w-auto"})]})]})})}},7402:(e,t,a)=>{"use strict";a.d(t,{TK:()=>o,Te:()=>c,ub:()=>d});var r=a(326),s=a(772),i=a(1291),n=a(1405),l=a(3211);function o({size:e="md",text:t,className:a=""}){let{t:s}=(0,l.Z)(),i=t||s("common.loading");return(0,r.jsxs)("div",{className:`flex flex-col items-center justify-center ${a}`,children:[r.jsx("div",{className:`animate-spin rounded-full border-b-2 border-[#11295b] ${{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[e]} mb-2`}),i&&r.jsx("p",{className:"text-gray-500 text-sm",children:i})]})}function c({error:e,onRetry:t,retryText:a,className:o=""}){let{t:c}=(0,l.Z)(),d=a||c("common.retry");return(0,r.jsxs)("div",{className:`flex flex-col items-center justify-center ${o}`,children:[r.jsx(i.Z,{className:"h-8 w-8 text-red-500 mb-2"}),r.jsx("p",{className:"text-red-500 mb-4 text-center",children:e}),t&&(0,r.jsxs)(s.z,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(n.Z,{className:"h-4 w-4"}),d]})]})}function d({title:e,description:t,icon:a,action:s,className:i=""}){return(0,r.jsxs)("div",{className:`flex flex-col items-center justify-center text-center ${i}`,children:[a&&r.jsx("div",{className:"mb-4",children:a}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e}),t&&r.jsx("p",{className:"text-gray-500 mb-4",children:t}),s&&r.jsx("div",{children:s})]})}},7912:(e,t,a)=>{"use strict";async function r(e,t){try{if("geolocation"in navigator&&"reverseGeocode"in navigator)throw Error("浏览器不支持反向地理编码");let a=await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${e}&longitude=${t}&localityLanguage=zh`);if(!a.ok)throw Error("地理编码服务不可用");let r=await a.json(),s=[];return r.locality&&s.push(r.locality),r.principalSubdivision&&s.push(r.principalSubdivision),r.countryName&&s.push(r.countryName),s.join("，")||`${e.toFixed(4)}, ${t.toFixed(4)}`}catch(a){return`${e.toFixed(4)}, ${t.toFixed(4)}`}}async function s(e){try{let t=await function(e={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5}){return new Promise((t,a)=>{if(!navigator.geolocation){a({code:-1,message:"浏览器不支持地理位置功能"});return}navigator.geolocation.getCurrentPosition(e=>{t({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy})},e=>{let t="获取地理位置失败";switch(e.code){case e.PERMISSION_DENIED:t="用户拒绝了地理位置请求";break;case e.POSITION_UNAVAILABLE:t="地理位置信息不可用";break;case e.TIMEOUT:t="获取地理位置超时";break;default:t="获取地理位置时发生未知错误"}a({code:e.code,message:t})},e)})}(e);return await r(t.latitude,t.longitude)}catch(e){return console.warn("获取地理位置失败，使用默认位置:",e),"中国，北京"}}async function i(){if(!navigator.permissions)return"prompt";try{return(await navigator.permissions.query({name:"geolocation"})).state}catch(e){return"prompt"}}a.d(t,{gI:()=>i,g_:()=>s})},1896:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},1890:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},1291:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7636:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},1405:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},4255:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(8570).createProxy)(String.raw`/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/brand-edit/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[898,728,591,951],()=>a(2836));module.exports=r})();