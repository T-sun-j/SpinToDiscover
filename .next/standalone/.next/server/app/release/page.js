(()=>{var e={};e.id=407,e.ids=[407],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7771:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>i.a,__next_app__:()=>g,originalPathname:()=>u,pages:()=>d,routeModule:()=>x,tree:()=>c}),a(1120),a(3169),a(5866);var s=a(3191),r=a(8716),l=a(7922),i=a.n(l),n=a(5231),o={};for(let e in n)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>n[e]);a.d(t,o);let c=["",{children:["release",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,1120)),"/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/release/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3169)),"/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/release/page.tsx"],u="/release/page",g={require:a,loadChunk:()=>Promise.resolve()},x=new s.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/release/page",pathname:"/release",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},9742:(e,t,a)=>{Promise.resolve().then(a.bind(a,1347))},1347:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var s=a(326),r=a(772),l=a(1890),i=a(4019),n=a(1896),o=a(7636),c=a(3211),d=a(3136),u=a(6968),g=a(3723),x=a(6370),h=a(6226),m=a(5047),p=a(7577),f=a(2991);function j(){let{t:e,language:t}=(0,c.Z)(),{authInfo:a,isAuthenticated:j}=(0,d.a)(),y=(0,m.useRouter)(),[b,v]=(0,p.useState)(!1),[w,N]=(0,p.useState)([]),[k,P]=(0,p.useState)([]),[S,$]=(0,p.useState)(null),[C,Z]=(0,p.useState)(null),[F,E]=(0,p.useState)(""),[L,T]=(0,p.useState)(""),[I,D]=(0,p.useState)(""),[M,U]=(0,p.useState)(""),[_,q]=(0,p.useState)(null),[A,z]=(0,p.useState)(!0),[B,R]=(0,p.useState)(!1),[O,V]=(0,p.useState)(""),[G,H]=(0,p.useState)(""),[W,K]=(0,p.useState)(""),[X,J]=(0,p.useState)(!1),Q=(0,p.useCallback)(()=>{if(!navigator.geolocation){V(e("releasePage.locationError"));return}J(!0),V(""),navigator.geolocation.getCurrentPosition(async a=>{try{let{latitude:e,longitude:s}=a.coords,r="en"===t?"en":"zh",l=await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${e}&longitude=${s}&localityLanguage=${r}`);if(l.ok){let e;let t=await l.json();e="en"===r?`${t.countryName||""}, ${t.city||t.locality||""}`:`${t.countryName||""}ï¼Œ${t.city||t.locality||""}`,K(e)}else K(`${e.toFixed(4)}, ${s.toFixed(4)}`)}catch(t){console.error("Failed to get address info:",t),K(e("releasePage.locationParseError"))}finally{J(!1)}},t=>{console.error("Failed to get location:",t);let a=e("releasePage.locationFailed");switch(t.code){case t.PERMISSION_DENIED:a=e("releasePage.locationPermissionDenied");break;case t.POSITION_UNAVAILABLE:a=e("releasePage.locationUnavailable");break;case t.TIMEOUT:a=e("releasePage.locationTimeout")}V(a),J(!1)},{enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5})},[t]),Y=(0,p.useCallback)(async()=>{if(!a){V(e("releasePage.authInfoMissing"));return}try{let e=await (0,f.bG)({email:a.email,userId:a.userId,token:a.token});if(e.success&&e.data){let t=e.data;q(t),t.brand&&D(t.brand),t.brief&&U(t.brief)}}catch(t){console.error("Failed to get user info:",t),V(e("releasePage.getUserInfoFailed"))}},[a]),ee=(0,p.useCallback)(()=>!!F.trim()||(V(e("releasePage.titleRequired")),!1),[F,e]),et=e=>{if(e.target.files&&e.target.files[0]){let t=e.target.files[0];P([...k,t]);let a=new FileReader;a.onloadend=()=>{N([...w,a.result])},a.readAsDataURL(t)}},ea=t=>{if(t.target.files&&t.target.files[0]){let a=t.target.files[0];if(S){V(e("releasePage.onlyOneVideoAllowed"));return}$(a),Z(URL.createObjectURL(a))}},es=e=>{N(w.filter((t,a)=>a!==e)),P(k.filter((t,a)=>a!==e))},er=async t=>{t.preventDefault(),R(!0),V(""),H("");try{if(!ee()){R(!1);return}let t=[],s="";if(k.length>0)for(let a of(H(e("releasePage.uploadingImages")),k))try{let e=await (0,f.gg)(a);if(e.success&&e.data){let a="string"==typeof e.data?e.data:e.data.img;a&&t.push(a)}}catch(t){console.error("Image upload failed:",t),V(`${e("releasePage.imageUploadError")}: ${t instanceof Error?t.message:e("releasePage.unknownError")}`),H(""),R(!1);return}if(S){H(e("releasePage.uploadingVideo"));try{let e=await (0,f.$x)(S);if(e.success&&e.data?.code===0)s=e.data.url;else throw Error(e.data?.msg||"Video upload failed")}catch(t){console.error("Video upload failed:",t),V(`${e("releasePage.videoUploadError")}: ${t instanceof Error?t.message:e("releasePage.unknownError")}`),H(""),R(!1);return}}let r={userId:a.userId,token:a.token,title:F.trim(),description:L.trim(),location:W||e("releasePage.gettingLocation"),images:t.join(","),video:s?"/"+s:"",intro:b?_?.brief||M:"",website:b&&_?.officialsite||"",logo:b&&_?.logo||"",customerService:b&&_?.tel||"",workingHours:b&&_?.address||""};H(e("releasePage.publishingContent"));let l=await (0,f.h5)(r);l.success?(H(e("releasePage.publishSuccess")),setTimeout(()=>{y.push("/personal")},2e3)):(V(l.message||e("releasePage.publishError")),H(""))}catch(t){V(t instanceof Error?t.message:e("releasePage.publishProcessError")),H("")}finally{R(!1)}};return s.jsx(x.a,{children:(0,s.jsxs)("main",{className:" flex min-h-dvh flex-col bg-white",children:[s.jsx(u.h,{showSearch:!0,showUser:!0}),(0,s.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 z-100",children:[s.jsx("h1",{className:"text-xl font-poppins text-[#0F1728] font-semibold",children:e("releasePage.title")}),s.jsx("button",{onClick:()=>{y.back()},className:"text-[#0F1728] hover:text-[#0F1728]",children:s.jsx(l.Z,{className:"h-7 w-7  z-10"})})]}),(0,s.jsxs)("form",{onSubmit:er,className:"flex-1 px-6 space-y-6",children:[s.jsx("div",{children:s.jsx("input",{type:"text",placeholder:e("releasePage.fieldTitle"),value:F,onChange:e=>E(e.target.value),className:"w-full rounded-full bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60",required:!0})}),s.jsx("div",{children:s.jsx("textarea",{placeholder:e("releasePage.fieldContent"),value:L,onChange:e=>T(e.target.value),rows:6,className:"w-full rounded-lg bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"grid grid-cols-4 gap-3",children:[w.map((e,t)=>(0,s.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden border border-gray-300",children:[s.jsx(h.default,{src:e,alt:"Uploaded",layout:"fill",objectFit:"cover"}),s.jsx("button",{type:"button",onClick:()=>es(t),className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 hover:bg-opacity-70",children:s.jsx(i.Z,{className:"h-3 w-3"})})]},`image-${t}`)),S&&C&&(0,s.jsxs)("div",{className:"relative aspect-square rounded-lg overflow-hidden border border-gray-300 bg-gray-100",children:[s.jsx("video",{src:C,className:"w-full h-full object-cover",muted:!0,preload:"metadata",onLoadedMetadata:e=>{e.currentTarget.currentTime=.1}}),s.jsx("button",{type:"button",onClick:()=>{C&&URL.revokeObjectURL(C),$(null),Z(null)},className:"absolute top-1 right-1 bg-black bg-opacity-50 text-white rounded-full p-1 hover:bg-opacity-70",children:s.jsx(i.Z,{className:"h-3 w-3"})})]}),w.length+(S?1:0)<8&&(0,s.jsxs)("label",{className:"aspect-square flex items-center justify-center rounded-lg border-2 border-dashed border-gray-300 cursor-pointer bg-gray-50 hover:bg-gray-100 transition-colors",children:[s.jsx("input",{type:"file",accept:S?"image/*":"image/*,video/*",className:"hidden",onChange:t=>{let a=t.target.files?.[0];if(a){if(a.type.startsWith("image/"))et(t);else if(a.type.startsWith("video/")){if(S){V(e("releasePage.onlyOneVideoAllowed")),t.target.value="";return}ea(t)}t.target.value=""}}}),(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[s.jsx(n.Z,{className:"h-6 w-6 text-gray-400 mb-1"}),s.jsx("span",{className:"text-xs text-gray-500 text-center",children:S?e("releasePage.addImage"):e("releasePage.addMedia")})]})]})]}),(0,s.jsxs)("div",{className:"mt-2 text-xs text-gray-500",children:[w.length+(S?1:0),"/8 ",e("releasePage.mediaFiles")]})]}),(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[s.jsx(o.Z,{className:"h-4 w-4 text-[#0F1728] font-semibold"}),s.jsx("span",{children:W||e("releasePage.gettingLocation")})]}),!W&&!X&&s.jsx("button",{type:"button",onClick:Q,className:"text-sm text-blue-500 hover:text-blue-700",children:e("releasePage.retryLocation")})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h2",{className:"text-xl font-inter text-[#0F1728] font-semibold",children:e("releasePage.advantageInfo")}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("label",{className:"relative h-4 w-4 flex items-center",children:[s.jsx("input",{type:"checkbox",checked:b,onChange:async e=>{let t=e.target.checked;v(t),t?await Y():(D(""),U(""),q(null))},className:"peer h-4 w-4 appearance-none border-1 rounded border-[#12295B] bg-white text-primary focus:ring-primary/60 checked:border-[#12295B] outline-none"}),s.jsx("span",{className:"pointer-events-none absolute left-0 top-0 h-4 w-4 flex items-center justify-center "+(b?"":"hidden"),children:s.jsx("svg",{className:"h-3 w-3 text-[#12295B]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]}),s.jsx("span",{className:"text-xs font-inter text-[#0F1728]",children:e("releasePage.fillBrandInfo")})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("div",{children:s.jsx("input",{type:"text",placeholder:e("releasePage.brandProductionName"),value:I,onChange:e=>D(e.target.value),className:"w-full rounded-full bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),s.jsx("div",{children:s.jsx("textarea",{placeholder:e("releasePage.briefDescription"),value:M,onChange:e=>U(e.target.value),rows:4,className:"w-full rounded-lg bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})})]})]}),O&&(0,s.jsxs)("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[s.jsx("div",{className:"h-2 w-2 rounded-full bg-red-500"}),s.jsx("span",{children:O})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("label",{className:"relative h-4 w-4 flex items-center",children:[s.jsx("input",{type:"checkbox",checked:A,onChange:e=>z(e.target.checked),className:"peer h-4 w-4 appearance-none border-1 rounded border-[#12295B] bg-white text-primary focus:ring-primary/60 checked:border-[#12295B] outline-none"}),s.jsx("span",{className:"pointer-events-none absolute left-0 top-0 h-4 w-4 flex items-center justify-center "+(A?"":"hidden"),children:s.jsx("svg",{className:"h-3 w-3 text-[#12295B]",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:s.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})})})]}),s.jsx("span",{className:"text-gray-700 text-sm",children:e("releasePage.allowingComments")})]}),s.jsx(r.z,{type:"submit",className:"w-full bg-[#11295b] text-white text-[17px] font-poppins font-semibold shadow-md rounded-lg",size:"lg",disabled:B||!!G&&!O,children:B?e("releasePage.publishing"):G&&!O?e("releasePage.publishSuccess"):e("releasePage.releaseButton")})]}),s.jsx(g.$,{})]})})}},6370:(e,t,a)=>{"use strict";a.d(t,{a:()=>d});var s=a(326),r=a(7577),l=a(5047),i=a(3136),n=a(3211),o=a(7402);let c=["/","/square","/login","/register","/forgot-password","/change-password","/personalization","/about","/privacy"];function d({children:e,fallback:t}){let{isAuthenticated:a,authInfo:d}=(0,i.a)(),{t:u}=(0,n.Z)();(0,l.useRouter)();let g=(0,l.usePathname)(),[x,h]=(0,r.useState)(!1);return c.some(e=>"/"===e?"/"===g:g.startsWith(e))?s.jsx(s.Fragment,{children:e}):a&&d?.userId&&d?.token?s.jsx(s.Fragment,{children:e}):t||s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:s.jsx("div",{className:"text-center",children:s.jsx(o.TK,{size:"lg",text:u("common.verifying")})})})}},3723:(e,t,a)=>{"use strict";a.d(t,{$:()=>o});var s=a(326),r=a(3211),l=a(6226);function i({transparent:e=!1}){let{language:t,setLanguage:a}=(0,r.Z)();return(0,s.jsxs)("button",{onClick:()=>{a("en"===t?"zh":"en")},className:`flex items-center ${e?"text-white":"text-[#0F1728]"} hover:opacity-80 transition-opacity`,"aria-label":`Switch to ${"en"===t?"Chinese":"English"}`,children:[s.jsx(l.default,{src:e?"/img/lang.png":"/img/lang-d.png",alt:"Language",width:24,height:24,className:"h-4 w-4"}),s.jsx("span",{className:`text-[10px] font-medium ml-1 ${e?"text-white":"text-[#0F1728]"}`,children:"en"===t?"EN":"CN"})]})}var n=a(434);function o({transparent:e=!1}){let{t}=(0,r.Z)();return s.jsx("footer",{className:`mt-auto text-[10px] py-4 px-4 w-full font-inter ${e?"text-white":"text-[#0F1728]"}`,children:(0,s.jsxs)("div",{className:"flex justify-between items-center w-full",children:[s.jsx("div",{className:"flex items-center gap-2 font-inter",children:s.jsx(i,{transparent:e})}),(0,s.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[s.jsx(n.default,{href:"/about",className:`${e?"text-white":"text-[#0F1728]"} font-inter`,children:t("footer.links.about")}),s.jsx(n.default,{href:"/privacy",className:`${e?"text-white":"text-[#0F1728]"} font-inter`,children:t("footer.links.privacy")}),s.jsx("span",{className:`${e?"text-white":"text-[#0F1728]"} font-inter`,children:t("footer.copyright")}),s.jsx(l.default,{src:e?"/img/logo-1.png":"/img/logo-2.png",alt:"Language",width:52,height:22,className:"h-5 w-auto"})]})]})})}},7402:(e,t,a)=>{"use strict";a.d(t,{TK:()=>o,Te:()=>c,ub:()=>d});var s=a(326),r=a(772),l=a(1291),i=a(1405),n=a(3211);function o({size:e="md",text:t,className:a=""}){let{t:r}=(0,n.Z)(),l=t||r("common.loading");return(0,s.jsxs)("div",{className:`flex flex-col items-center justify-center ${a}`,children:[s.jsx("div",{className:`animate-spin rounded-full border-b-2 border-[#11295b] ${{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[e]} mb-2`}),l&&s.jsx("p",{className:"text-gray-500 text-sm",children:l})]})}function c({error:e,onRetry:t,retryText:a,className:o=""}){let{t:c}=(0,n.Z)(),d=a||c("common.retry");return(0,s.jsxs)("div",{className:`flex flex-col items-center justify-center ${o}`,children:[s.jsx(l.Z,{className:"h-8 w-8 text-red-500 mb-2"}),s.jsx("p",{className:"text-red-500 mb-4 text-center",children:e}),t&&(0,s.jsxs)(r.z,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[s.jsx(i.Z,{className:"h-4 w-4"}),d]})]})}function d({title:e,description:t,icon:a,action:r,className:l=""}){return(0,s.jsxs)("div",{className:`flex flex-col items-center justify-center text-center ${l}`,children:[a&&s.jsx("div",{className:"mb-4",children:a}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e}),t&&s.jsx("p",{className:"text-gray-500 mb-4",children:t}),r&&s.jsx("div",{children:r})]})}},1896:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},1890:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},1291:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7636:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},1405:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},4019:(e,t,a)=>{"use strict";a.d(t,{Z:()=>s});let s=(0,a(2881).Z)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},1120:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>s});let s=(0,a(8570).createProxy)(String.raw`/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/release/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),s=t.X(0,[898,728,591,951],()=>a(7771));module.exports=s})();