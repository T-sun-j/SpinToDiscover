(()=>{var e={};e.id=560,e.ids=[560],e.modules={2934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},4580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},5869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},7448:(e,t,a)=>{"use strict";a.r(t),a.d(t,{GlobalError:()=>n.a,__next_app__:()=>x,originalPathname:()=>u,pages:()=>c,routeModule:()=>g,tree:()=>d}),a(4255),a(3169),a(5866);var r=a(3191),s=a(8716),i=a(7922),n=a.n(i),l=a(5231),o={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);a.d(t,o);let d=["",{children:["brand-edit",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4255)),"/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/brand-edit/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(a.bind(a,3169)),"/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,5866,23)),"next/dist/client/components/not-found-error"]}],c=["/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/brand-edit/page.tsx"],u="/brand-edit/page",x={require:a,loadChunk:()=>Promise.resolve()},g=new r.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/brand-edit/page",pathname:"/brand-edit",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},1508:(e,t,a)=>{Promise.resolve().then(a.bind(a,2910))},2910:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>j});var r=a(326),s=a(772),i=a(1890),n=a(1896),l=a(7636),o=a(3211),d=a(6679),c=a(6219),u=a(5047),x=a(7577),g=a(3136),m=a(6370),f=a(2991),p=a(5128),h=a(6260),b=a(7912),y=a(6824);function j(){let{t:e}=(0,o.Z)(),t=(0,u.useRouter)(),{getEmail:a}=(0,g.a)(),{userParams:j}=(0,g.z)(),[v,N]=(0,x.useState)({brand:"",brief:"",logo:"",officialsite:"",tel:"",address:"",location:""}),[E,P]=(0,x.useState)(!1),[w,_]=(0,x.useState)(null),[I,S]=(0,x.useState)(!1),[T,A]=(0,x.useState)(null),[L,M]=(0,x.useState)(""),[k,R]=(0,x.useState)(!1),[D,C]=(0,x.useState)(!0),[O,U]=(0,x.useState)(!1),Z=(0,x.useRef)(null);(0,x.useRef)(!1);let F=(0,x.useCallback)(async()=>{U(!0),_(null);try{let e=await (0,b.g_)({enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5});N(t=>({...t,location:e}))}catch(a){console.error("获取位置失败:",a);let t=e("brandEditPage.locationFailed");if(a&&"object"==typeof a&&"code"in a)switch(a.code){case 1:t=e("brandEditPage.locationPermissionDenied");break;case 2:t=e("brandEditPage.locationUnavailable");break;case 3:t=e("brandEditPage.locationTimeout");break;case -1:t=e("brandEditPage.locationError")}_(t)}finally{U(!1)}},[e]),G=(e,t)=>{N(a=>({...a,[e]:t}))},Y=async t=>{let a=t.target.files?.[0];if(a){if(!a.type.startsWith("image/")){_(e("brandEditPage.invalidImageType"));return}if(a.size>10485760){_(e("brandEditPage.imageTooLarge"));return}A(a),R(!0),_(null);try{let t=new FileReader;t.onload=e=>{M(e.target?.result)},t.readAsDataURL(a);let r=await (0,f.gg)(a);if(r.success&&r.data){let e="string"==typeof r.data?r.data:r.data.img;e&&(N(t=>({...t,logo:e})),M((0,y.nJ)(e)))}else throw Error(r.message||e("brandEditPage.logoUploadFailed"))}catch(t){console.error("Logo upload failed:",t),_(t instanceof Error?t.message:e("brandEditPage.logoUploadFailed")),A(null),M("")}finally{R(!1)}}},z=async()=>{if(!a()){_(e("brandEditPage.loginRequired"));return}if(!v.brand.trim()){_(e("brandEditPage.brandRequired")||"品牌名称不能为空");return}P(!0),_(null);try{if(!j){_(e("brandEditPage.authInfoMissing"));return}let r=await (0,f.I)({email:a(),userId:j.userId,token:j.token,brand:v.brand,brief:v.brief,logo:v.logo,officialsite:v.officialsite,tel:v.tel,address:v.address,location:v.location});r.success?(S(!0),setTimeout(()=>{t.push("/personal")},2e3)):_(r.message||e("brandEditPage.submitError"))}catch(t){_(t instanceof Error?t.message:e("brandEditPage.submitError"))}finally{P(!1)}};return r.jsx(m.a,{children:(0,r.jsxs)("main",{className:"flex min-h-dvh flex-col bg-white",children:[r.jsx(d.h,{showLanguage:!0}),(0,r.jsxs)("div",{className:"flex items-center justify-between px-6 py-4",children:[r.jsx("h1",{className:"text-xl text-[#11295b] font-poppins",children:e("brandEditPage.title")}),r.jsx("button",{onClick:()=>t.push("/personal"),className:"text-[#11295b] hover:text-[#11295b]",children:r.jsx(i.Z,{className:(0,p.AK)(h.vR.SIZES.ICON_LG,h.vR.COLORS.PRIMARY)})})]}),D?r.jsx("div",{className:"flex-1 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-[#11295b] mx-auto mb-4"}),r.jsx("p",{className:"text-gray-500",children:e("brandEditPage.loading")})]})}):(0,r.jsxs)("form",{onSubmit:e=>{e.preventDefault(),z()},className:"flex-1 px-6 py-4 space-y-6",children:[r.jsx("div",{children:r.jsx("input",{type:"text",placeholder:e("brandEditPage.brand"),value:v.brand,onChange:e=>G("brand",e.target.value),className:"w-full rounded-full bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60",required:!0})}),r.jsx("div",{children:r.jsx("textarea",{placeholder:e("brandEditPage.brief"),value:v.brief,onChange:e=>G("brief",e.target.value),rows:4,className:"w-full rounded-lg bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),(0,r.jsxs)("div",{className:"flex flex-col items-start",children:[(0,r.jsxs)("label",{className:`w-20 h-20 flex flex-col items-center justify-center rounded-xl bg-gray-200 cursor-pointer relative overflow-hidden ${k?"opacity-50 pointer-events-none":""}`,children:[r.jsx("input",{ref:Z,type:"file",accept:"image/*",onChange:Y,className:"hidden",disabled:k}),L?(0,r.jsxs)("div",{className:"w-full h-full relative",children:[r.jsx("img",{src:L,alt:"Logo preview",className:"w-full h-full object-cover rounded-xl"}),k&&r.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:r.jsx("div",{className:"text-white text-xs",children:"上传中..."})})]}):(0,r.jsxs)("div",{className:"flex flex-col items-center",children:[r.jsx(n.Z,{className:"h-8 w-8 text-gray-400 mt-2"}),r.jsx("span",{className:"block mt-2 text-gray-500 text-sm font-normal",children:k?e("brandEditPage.uploading"):e("brandEditPage.logo")})]})]}),T&&!k&&v.logo&&r.jsx("div",{className:"mt-2 text-xs text-green-600",children:e("brandEditPage.logoUploaded")})]}),r.jsx("div",{children:r.jsx("input",{type:"url",placeholder:e("brandEditPage.officialSite"),value:v.officialsite,onChange:e=>G("officialsite",e.target.value),className:"w-full rounded-full bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),r.jsx("div",{children:r.jsx("input",{type:"tel",placeholder:e("brandEditPage.telMobile"),value:v.tel,onChange:e=>G("tel",e.target.value),className:"w-full rounded-full bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),r.jsx("div",{children:r.jsx("textarea",{placeholder:e("brandEditPage.address"),value:v.address,onChange:e=>G("address",e.target.value),rows:3,className:"w-full rounded-lg bg-gray-200 px-4 py-3 text-gray-900 placeholder:text-gray-500 focus:outline-none focus:ring-2 focus:ring-primary/60"})}),(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[r.jsx(l.Z,{className:"h-4 w-4"}),(0,r.jsxs)("span",{children:[e("brandEditPage.location"),": ",v.location||e("brandEditPage.gettingLocation")]})]}),!O&&!v.location&&(0,r.jsxs)("button",{type:"button",onClick:F,className:"text-sm text-blue-500 hover:text-blue-700 flex items-center gap-1",children:[r.jsx(l.Z,{className:"h-3 w-3"}),e("brandEditPage.getCurrentLocation")]}),O&&(0,r.jsxs)("div",{className:"flex items-center gap-1 text-sm text-blue-500",children:[r.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-blue-500"}),e("brandEditPage.gettingLocation")]})]}),w&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-red-500 text-sm",children:[r.jsx("div",{className:"h-2 w-2 rounded-full bg-red-500"}),r.jsx("span",{children:w})]}),I&&(0,r.jsxs)("div",{className:"flex items-center gap-2 text-green-500 text-sm",children:[r.jsx("div",{className:"h-2 w-2 rounded-full bg-green-500"}),r.jsx("span",{children:e("brandEditPage.submitSuccess")})]}),r.jsx(s.z,{type:"submit",className:"w-full bg-[#11295b] text-white shadow-md rounded-lg",size:"lg",disabled:E||!!I,children:E?e("brandEditPage.submitting"):e("brandEditPage.submit")})]}),r.jsx("div",{className:"mt-auto",children:r.jsx(c.$,{})})]})})}},6370:(e,t,a)=>{"use strict";a.d(t,{a:()=>c});var r=a(326),s=a(7577),i=a(5047),n=a(3136),l=a(3211),o=a(7402);let d=["/","/square","/login","/register","/forgot-password","/change-password","/personalization","/about","/privacy"];function c({children:e,fallback:t}){let{isAuthenticated:a,authInfo:c}=(0,n.a)(),{t:u}=(0,l.Z)();(0,i.useRouter)();let x=(0,i.usePathname)(),[g,m]=(0,s.useState)(!1);return d.some(e=>"/"===e?"/"===x:x.startsWith(e))?r.jsx(r.Fragment,{children:e}):a&&c?.userId&&c?.token?r.jsx(r.Fragment,{children:e}):t||r.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:r.jsx("div",{className:"text-center",children:r.jsx(o.TK,{size:"lg",text:u("common.verifying")})})})}},6219:(e,t,a)=>{"use strict";a.d(t,{$:()=>d});var r=a(326),s=a(3211),i=a(772),n=a(7863);function l(){let{language:e,setLanguage:t,t:a}=(0,s.Z)();return(0,r.jsxs)("div",{className:"flex items-center gap-2 mr-1",children:[r.jsx(i.z,{variant:"ghost",size:"sm",className:(0,n.cn)("text-[11px] px-0 py-1 h-auto font-inter","text-muted-foreground"),children:a("footer.language.en")}),r.jsx(i.z,{variant:"ghost",size:"sm",className:(0,n.cn)("text-[11px] px-0 py-1 h-auto font-inter","text-muted-foreground"),children:a("footer.language.zh")})]})}var o=a(434);function d(){let{t:e}=(0,s.Z)();return r.jsx("footer",{className:"mt-auto text-[11px] text-muted-foreground py-2 px-2 w-full font-inter",children:(0,r.jsxs)("div",{className:"flex justify-between items-center w-full",children:[r.jsx("div",{className:"flex items-center gap-2 font-inter",children:r.jsx(l,{})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[r.jsx(o.default,{href:"/about",className:"text-muted-foreground font-inter",children:e("footer.links.about")}),r.jsx(o.default,{href:"/privacy",className:"text-muted-foreground font-inter",children:e("footer.links.privacy")}),r.jsx("span",{className:"text-muted-foreground font-inter",children:e("footer.copyright")})]})]})})}},7402:(e,t,a)=>{"use strict";a.d(t,{TK:()=>o,Te:()=>d,ub:()=>c});var r=a(326),s=a(772),i=a(1291),n=a(1405),l=a(3211);function o({size:e="md",text:t,className:a=""}){let{t:s}=(0,l.Z)(),i=t||s("common.loading");return(0,r.jsxs)("div",{className:`flex flex-col items-center justify-center ${a}`,children:[r.jsx("div",{className:`animate-spin rounded-full border-b-2 border-[#11295b] ${{sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[e]} mb-2`}),i&&r.jsx("p",{className:"text-gray-500 text-sm",children:i})]})}function d({error:e,onRetry:t,retryText:a,className:o=""}){let{t:d}=(0,l.Z)(),c=a||d("common.retry");return(0,r.jsxs)("div",{className:`flex flex-col items-center justify-center ${o}`,children:[r.jsx(i.Z,{className:"h-8 w-8 text-red-500 mb-2"}),r.jsx("p",{className:"text-red-500 mb-4 text-center",children:e}),t&&(0,r.jsxs)(s.z,{onClick:t,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[r.jsx(n.Z,{className:"h-4 w-4"}),c]})]})}function c({title:e,description:t,icon:a,action:s,className:i=""}){return(0,r.jsxs)("div",{className:`flex flex-col items-center justify-center text-center ${i}`,children:[a&&r.jsx("div",{className:"mb-4",children:a}),r.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:e}),t&&r.jsx("p",{className:"text-gray-500 mb-4",children:t}),s&&r.jsx("div",{children:s})]})}},6260:(e,t,a)=>{"use strict";a.d(t,{$w:()=>n,ZX:()=>r,iK:()=>i,vR:()=>s});let r={DEFAULT_PAGE:1,DEFAULT_LIMIT:999,MAX_LIMIT:100,REQUEST_TIMEOUT:1e4,MAX_RETRIES:3},s={COLORS:{PRIMARY:"#11295b",PRIMARY_OPACITY_80:"#11295b/80",PRIMARY_OPACITY_60:"#11295b/60",GRAY_100:"bg-gray-100",GRAY_400:"text-gray-400",RED_500:"text-red-500",WHITE:"text-white"},FONTS:{POPPINS:"font-poppins",NUNITO:"font-nunito",INTER:"font-inter"},FONT_WEIGHTS:{SEMIBOLD:"font-semibold",NORMAL:"font-normal"},SIZES:{ICON_SM:"h-3.5 w-3.5",ICON_MD:"h-6 w-6",ICON_LG:"h-7 w-7",ICON_XL:"h-8 w-8"},SPACING:{GAP_2:"gap-2",GAP_4:"gap-4",MB_2:"mb-2",MB_4:"mb-4",MB_6:"mb-6",MY_4:"my-4",PX_6:"px-6",PY_2:"py-2",PY_8:"py-8",PY_12:"py-12",PB_6:"pb-6"},BORDER_RADIUS:{ROUNDED_MD:"rounded-md",ROUNDED_FULL:"rounded-full"},EFFECTS:{OPACITY_50:"opacity-50",OPACITY_80:"/80",OPACITY_60:"/60"}},i={IMAGES:{MAX_THUMBNAILS:3,DEFAULT_IMAGE:"/img/band.png",THUMBNAIL_SIZE:{width:360,height:220},THUMBNAIL_CLASS:"w-full h-28 object-cover rounded-md"},LAYOUT:{GRID_COLS_3:"grid-cols-3",MIN_HEIGHT_DVH:"min-h-dvh",FLEX_COL:"flex-col",FLEX_CENTER:"flex items-center justify-center",FLEX_BETWEEN:"flex items-center justify-between"},TEXT_SIZES:{TITLE:"text-2xl",SUBTITLE:"text-lg",BODY:"text-[15px]",SMALL:"text-sm",XS:"text-xs"}},n={SPIN:"animate-spin",FADE_IN:"animate-fade-in",SLIDE_UP:"animate-slide-up"}},5128:(e,t,a)=>{"use strict";a.d(t,{AK:()=>s});var r=a(7863);function s(...e){return(0,r.cn)(...e.filter(Boolean))}},7912:(e,t,a)=>{"use strict";async function r(e,t){try{if("geolocation"in navigator&&"reverseGeocode"in navigator)throw Error("浏览器不支持反向地理编码");let a=await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${e}&longitude=${t}&localityLanguage=zh`);if(!a.ok)throw Error("地理编码服务不可用");let r=await a.json(),s=[];return r.locality&&s.push(r.locality),r.principalSubdivision&&s.push(r.principalSubdivision),r.countryName&&s.push(r.countryName),s.join("，")||`${e.toFixed(4)}, ${t.toFixed(4)}`}catch(a){return`${e.toFixed(4)}, ${t.toFixed(4)}`}}async function s(e){try{let t=await function(e={enableHighAccuracy:!0,timeout:1e4,maximumAge:3e5}){return new Promise((t,a)=>{if(!navigator.geolocation){a({code:-1,message:"浏览器不支持地理位置功能"});return}navigator.geolocation.getCurrentPosition(e=>{t({latitude:e.coords.latitude,longitude:e.coords.longitude,accuracy:e.coords.accuracy})},e=>{let t="获取地理位置失败";switch(e.code){case e.PERMISSION_DENIED:t="用户拒绝了地理位置请求";break;case e.POSITION_UNAVAILABLE:t="地理位置信息不可用";break;case e.TIMEOUT:t="获取地理位置超时";break;default:t="获取地理位置时发生未知错误"}a({code:e.code,message:t})},e)})}(e);return await r(t.latitude,t.longitude)}catch(e){return console.warn("获取地理位置失败，使用默认位置:",e),"中国，北京"}}async function i(){if(!navigator.permissions)return"prompt";try{return(await navigator.permissions.query({name:"geolocation"})).state}catch(e){return"prompt"}}a.d(t,{gI:()=>i,g_:()=>s})},1896:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},1890:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},1291:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},7636:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},1405:(e,t,a)=>{"use strict";a.d(t,{Z:()=>r});let r=(0,a(2881).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},4255:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>r});let r=(0,a(8570).createProxy)(String.raw`/Users/jinjing/Desktop/jj/code1/SpinToDiscover/SpinToDiscover/app/brand-edit/page.tsx#default`)}};var t=require("../../webpack-runtime.js");t.C(e);var a=e=>t(t.s=e),r=t.X(0,[845,608,203,555],()=>a(7448));module.exports=r})();