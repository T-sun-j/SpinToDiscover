(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[455],{8142:function(e,t,n){Promise.resolve().then(n.bind(n,8616))},8616:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return I}});var r=n(7437),o=n(2451),l=n(1817),s=n(9322),i=n(759),c=n(9512),a=n(8444),u=n(2690),d=n(7648),f=n(3145),g=n(9376),x=n(2265),m=n(7471),h=n(6023),p=n(9116),N=n(6652),v=n(8685);function I(){let{t:e}=(0,i.Z)(),t=(0,g.useRouter)(),[n,I]=(0,x.useState)("following"),[R,w]=(0,x.useState)([]),[_,j]=(0,x.useState)([]),y=(0,x.useRef)(!1),b=(0,x.useRef)(!1),{data:A,loading:S,error:E,execute:O,userParams:P}=(0,m.h)(async e=>await (0,h.Ir)({userId:e.userId,token:e.token}),null),{data:L,loading:T,error:C,execute:k}=(0,m.h)(async e=>await (0,h.wo)({userId:e.userId,token:e.token}),null);(0,x.useEffect)(()=>{P&&P.userId&&P.token&&!y.current&&(y.current=!0,O())},[null==P?void 0:P.userId,null==P?void 0:P.token,O]),(0,x.useEffect)(()=>{P&&P.userId&&P.token&&!b.current&&(b.current=!0,k())},[null==P?void 0:P.userId,null==P?void 0:P.token,k]),(0,x.useEffect)(()=>{A&&A.success&&A.dataList&&(console.log("关注列表数据:",A.dataList),w(A.dataList))},[A]),(0,x.useEffect)(()=>{L&&L.success&&L.dataList&&(console.log("粉丝列表数据:",L.dataList),j(L.dataList))},[L]);let M=e=>{I(e),P&&P.userId&&P.token&&("following"===e?O():"follower"===e&&k())},D="following"===n?R:_;console.log("currentUsers:",D);let U="following"===n?S:T,F="following"===n?E:C;return(0,r.jsx)(u.a,{children:(0,r.jsxs)("main",{className:"flex min-h-dvh flex-col bg-white",children:[(0,r.jsx)(c.h,{showLanguage:!0,showSearch:!0,showUser:!0}),(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-2 border-b border-gray-700",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>M("following"),className:"text-lg font-semibold font-nunito px-6 py-2 rounded-full ".concat("following"===n?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-sm":"text-gray-500"),children:e("followedPage.following")}),(0,r.jsx)("button",{onClick:()=>M("follower"),className:"text-lg font-semibold font-nunito px-4 py-2 rounded-full ".concat("follower"===n?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-sm":"text-gray-500"),children:e("followedPage.follower")})]}),(0,r.jsx)("button",{onClick:()=>{t.back()},className:"text-[#11295b] hover:text-[#11295b] font-nunito",children:(0,r.jsx)(o.Z,{className:"h-7 w-7"})})]}),U&&(0,r.jsxs)("div",{className:(0,N.AK)("flex items-center justify-center",v.vR.SPACING.PY_8),children:[(0,r.jsx)(l.Z,{className:(0,N.AK)(v.vR.SIZES.ICON_MD,v.$w.SPIN,v.vR.COLORS.PRIMARY)}),(0,r.jsx)("span",{className:(0,N.AK)("ml-2 text-[#11295b]",v.vR.COLORS.PRIMARY,v.vR.FONTS.NUNITO),children:e("followedPage.loading")})]}),F&&(0,r.jsxs)("div",{className:(0,N.AK)("flex items-center justify-center",v.vR.SPACING.PY_8),children:[(0,r.jsx)(s.Z,{className:(0,N.AK)(v.vR.SIZES.ICON_MD,v.vR.COLORS.RED_500)}),(0,r.jsx)("span",{className:(0,N.AK)("ml-2 text-[#11295b]",v.vR.COLORS.RED_500,v.vR.FONTS.NUNITO),children:e("followedPage.error")})]}),!U&&!F&&0===D.length&&(0,r.jsxs)("div",{className:(0,N.AK)("flex flex-col items-center justify-center text-[#11295b]",v.vR.SPACING.PY_12),children:[(0,r.jsx)("div",{className:(0,N.AK)("w-16 h-16",v.vR.COLORS.GRAY_100,v.vR.BORDER_RADIUS.ROUNDED_FULL,"flex items-center justify-center",v.vR.SPACING.MB_4),children:(0,r.jsx)(s.Z,{className:(0,N.AK)(v.vR.SIZES.ICON_XL,v.vR.COLORS.GRAY_400)})}),(0,r.jsx)("h3",{className:(0,N.AK)("text-lg",v.vR.FONT_WEIGHTS.SEMIBOLD,v.vR.COLORS.PRIMARY,v.vR.FONTS.NUNITO,v.vR.SPACING.MB_2),children:e("following"===n?"followedPage.noFollowing":"followedPage.noFollowers")}),(0,r.jsx)("p",{className:(0,N.AK)(v.vR.COLORS.PRIMARY_OPACITY_60,v.vR.FONTS.INTER,"text-center text-[#11295b]"),children:e("following"===n?"followedPage.noFollowingDescription":"followedPage.noFollowersDescription")})]}),!U&&!F&&D.length>0&&(0,r.jsx)("div",{className:"flex-1 px-4 py-4 space-y-4",children:D.map(e=>(0,r.jsxs)(d.default,{href:"/personal/".concat(e.userId),children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 p-2 hover:bg-gray-50 rounded-lg",children:[(0,r.jsx)(f.default,{src:(0,p.nJ)(e.avatar),alt:e.nickname,width:48,height:48,className:"rounded-full w-10 h-10 object-cover"}),(0,r.jsx)("span",{className:"text-lg text-[#11295b] font-nunito",children:e.nickname})]}),(0,r.jsx)("div",{style:{borderBottom:"1px solid #e5e7eb"}})]},e.userId))}),(0,r.jsx)(a.$,{})]})})}},2690:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var r=n(7437),o=n(2265),l=n(9376),s=n(6281),i=n(759),c=n(8783);let a=["/","/square","/login","/register","/forgot-password","/change-password","/personalization","/about","/privacy"];function u(e){return a.some(t=>"/"===t?"/"===e:e.startsWith(t))}function d(e){let{children:t,fallback:n}=e,{isAuthenticated:a,authInfo:d}=(0,s.a)(),{t:f}=(0,i.Z)(),g=(0,l.useRouter)(),x=(0,l.usePathname)(),[m,h]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{let e=setTimeout(()=>{h(!0)},100);return()=>clearTimeout(e)},[]),(0,o.useEffect)(()=>{if(!m){console.log("AuthGuard: Waiting for initialization...");return}if(console.log("AuthGuard useEffect triggered:",{pathname:x,search:window.location.search,isAuthenticated:a,hasAuthInfo:!!d,isPublic:u(x),isInitialized:m}),u(x)){console.log("Public path, no auth check needed");return}if(a&&(null==d?void 0:d.userId)&&(null==d?void 0:d.token))console.log("User is authenticated, allowing access");else{let e;if(console.log("User not authenticated, checking for redirect loop"),function(e,t){if(console.log("Checking for redirect loop:",{pathname:e,search:t}),e.startsWith("/login"))return console.log("Current path is login page, preventing redirect"),!0;let n=new URLSearchParams(t).get("redirect");if(n){console.log("Found redirect parameter:",n);try{let e=decodeURIComponent(n);if(console.log("Decoded redirect:",e),e.includes("/login"))return console.log("Redirect contains /login, preventing loop"),!0;if(e.includes("redirect="))return console.log("Redirect contains nested redirect parameter, preventing loop"),!0;if(e.includes("?"))return console.log("Redirect contains query parameters, preventing loop"),!0;if(e.includes("%2Flogin")||e.includes("%252Flogin"))return console.log("Redirect contains encoded login path, preventing loop"),!0}catch(e){return console.warn("Failed to decode redirect parameter:",n,e),!0}}return console.log("No redirect loop detected"),!1}(x,window.location.search)){console.warn("Prevented redirect loop to login page");return}if("/login"===x){console.warn("Already on login page, preventing redirect");return}window.location.search.includes("redirect=")?(e="/login",console.log("Existing redirect detected, using default login URL")):console.log("Redirecting to login:",e="/login?redirect=".concat(encodeURIComponent(x))),g.push(e)}},[a,d,x,g,m]),u(x))?(0,r.jsx)(r.Fragment,{children:t}):a&&(null==d?void 0:d.userId)&&(null==d?void 0:d.token)?(0,r.jsx)(r.Fragment,{children:t}):n||(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(c.TK,{size:"lg",text:f("common.verifying")})})})}},8444:function(e,t,n){"use strict";n.d(t,{$:function(){return a}});var r=n(7437),o=n(759),l=n(2869),s=n(4508);function i(){let{language:e,setLanguage:t,t:n}=(0,o.Z)();return(0,r.jsxs)("div",{className:"flex items-center gap-2 mr-1",children:[(0,r.jsx)(l.z,{variant:"ghost",size:"sm",className:(0,s.cn)("text-[11px] px-0 py-1 h-auto font-inter","text-muted-foreground"),children:n("footer.language.en")}),(0,r.jsx)(l.z,{variant:"ghost",size:"sm",className:(0,s.cn)("text-[11px] px-0 py-1 h-auto font-inter","text-muted-foreground"),children:n("footer.language.zh")})]})}var c=n(7648);function a(){let{t:e}=(0,o.Z)();return(0,r.jsx)("footer",{className:"mt-auto text-[11px] text-muted-foreground py-2 px-2 w-full font-inter",children:(0,r.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,r.jsx)("div",{className:"flex items-center gap-2 font-inter",children:(0,r.jsx)(i,{})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[(0,r.jsx)(c.default,{href:"/about",className:"text-muted-foreground font-inter",children:e("footer.links.about")}),(0,r.jsx)(c.default,{href:"/privacy",className:"text-muted-foreground font-inter",children:e("footer.links.privacy")}),(0,r.jsx)("span",{className:"text-muted-foreground font-inter",children:e("footer.copyright")})]})]})})}},8783:function(e,t,n){"use strict";n.d(t,{TK:function(){return c},Te:function(){return a},ub:function(){return u}});var r=n(7437),o=n(2869),l=n(9322),s=n(7168),i=n(759);function c(e){let{size:t="md",text:n,className:o=""}=e,{t:l}=(0,i.Z)(),s=n||l("common.loading");return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(o),children:[(0,r.jsx)("div",{className:"animate-spin rounded-full border-b-2 border-[#11295b] ".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t]," mb-2")}),s&&(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:s})]})}function a(e){let{error:t,onRetry:n,retryText:c,className:a=""}=e,{t:u}=(0,i.Z)(),d=c||u("common.retry");return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(a),children:[(0,r.jsx)(l.Z,{className:"h-8 w-8 text-red-500 mb-2"}),(0,r.jsx)("p",{className:"text-red-500 mb-4 text-center",children:t}),n&&(0,r.jsxs)(o.z,{onClick:n,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,r.jsx)(s.Z,{className:"h-4 w-4"}),d]})]})}function u(e){let{title:t,description:n,icon:o,action:l,className:s=""}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center text-center ".concat(s),children:[o&&(0,r.jsx)("div",{className:"mb-4",children:o}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),n&&(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:n}),l&&(0,r.jsx)("div",{children:l})]})}},8685:function(e,t,n){"use strict";n.d(t,{$w:function(){return s},ZX:function(){return r},iK:function(){return l},vR:function(){return o}});let r={DEFAULT_PAGE:1,DEFAULT_LIMIT:999,MAX_LIMIT:100,REQUEST_TIMEOUT:1e4,MAX_RETRIES:3},o={COLORS:{PRIMARY:"#11295b",PRIMARY_OPACITY_80:"#11295b/80",PRIMARY_OPACITY_60:"#11295b/60",GRAY_100:"bg-gray-100",GRAY_400:"text-gray-400",RED_500:"text-red-500",WHITE:"text-white"},FONTS:{POPPINS:"font-poppins",NUNITO:"font-nunito",INTER:"font-inter"},FONT_WEIGHTS:{SEMIBOLD:"font-semibold",NORMAL:"font-normal"},SIZES:{ICON_SM:"h-3.5 w-3.5",ICON_MD:"h-6 w-6",ICON_LG:"h-7 w-7",ICON_XL:"h-8 w-8"},SPACING:{GAP_2:"gap-2",GAP_4:"gap-4",MB_2:"mb-2",MB_4:"mb-4",MB_6:"mb-6",MY_4:"my-4",PX_6:"px-6",PY_2:"py-2",PY_8:"py-8",PY_12:"py-12",PB_6:"pb-6"},BORDER_RADIUS:{ROUNDED_MD:"rounded-md",ROUNDED_FULL:"rounded-full"},EFFECTS:{OPACITY_50:"opacity-50",OPACITY_80:"/80",OPACITY_60:"/60"}},l={IMAGES:{MAX_THUMBNAILS:3,DEFAULT_IMAGE:"/img/band.png",THUMBNAIL_SIZE:{width:360,height:220},THUMBNAIL_CLASS:"w-full h-28 object-cover rounded-md"},LAYOUT:{GRID_COLS_3:"grid-cols-3",MIN_HEIGHT_DVH:"min-h-dvh",FLEX_COL:"flex-col",FLEX_CENTER:"flex items-center justify-center",FLEX_BETWEEN:"flex items-center justify-between"},TEXT_SIZES:{TITLE:"text-2xl",SUBTITLE:"text-lg",BODY:"text-[15px]",SMALL:"text-sm",XS:"text-xs"}},s={SPIN:"animate-spin",FADE_IN:"animate-fade-in",SLIDE_UP:"animate-slide-up"}},7471:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var r=n(2265),o=n(9376),l=n(6281);function s(e,t){let[n,s]=(0,r.useState)({data:null,loading:!1,error:null,success:!1}),i=(0,o.useSearchParams)(),{userParams:c}=(0,l.z)(),a=(0,r.useCallback)(()=>{if(c)return c;let e=i.get("userId"),t=i.get("token"),n=i.get("email");return e&&t?{userId:e,token:t,email:n||void 0}:null},[i,c]),u=(0,r.useCallback)(async n=>{let r=n||a();if(!r){t&&s({data:t,loading:!1,error:null,success:!0});return}s(e=>({...e,loading:!0,error:null}));try{let t=await e(r);s({data:t,loading:!1,error:null,success:!0})}catch(e){s({data:t||null,loading:!1,error:e instanceof Error?e.message:"请求失败",success:!1})}},[e,a,t]),d=(0,r.useCallback)(()=>{s({data:null,loading:!1,error:null,success:!1})},[]);return{...n,execute:u,reset:d,userParams:a()}}},6652:function(e,t,n){"use strict";n.d(t,{AK:function(){return o}});var r=n(4508);function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.cn)(...t.filter(Boolean))}},2451:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},9322:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1817:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7168:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},function(e){e.O(0,[516,51,282,971,117,744],function(){return e(e.s=8142)}),_N_E=e.O()}]);