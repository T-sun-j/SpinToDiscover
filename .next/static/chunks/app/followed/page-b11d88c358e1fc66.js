(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[455],{8142:function(e,t,n){Promise.resolve().then(n.bind(n,8616))},8616:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return v}});var r=n(7437),o=n(2451),l=n(1817),s=n(9322),i=n(759),c=n(4196),a=n(1839),u=n(2690),d=n(7648),f=n(3145),g=n(9376),h=n(2265),x=n(7471),m=n(6023),p=n(9116),w=n(6652),N=n(8685);function v(){let{t:e}=(0,i.Z)(),t=(0,g.useRouter)(),[n,v]=(0,h.useState)("following"),[R,I]=(0,h.useState)([]),[j,_]=(0,h.useState)([]),A=(0,h.useRef)(!1),y=(0,h.useRef)(!1),{data:E,loading:S,error:b,execute:O,userParams:C}=(0,x.h)(async e=>await (0,m.Ir)({userId:e.userId,token:e.token}),null),{data:L,loading:P,error:k,execute:T}=(0,x.h)(async e=>await (0,m.wo)({userId:e.userId,token:e.token}),null);(0,h.useEffect)(()=>{C&&C.userId&&C.token&&!A.current&&(A.current=!0,O())},[null==C?void 0:C.userId,null==C?void 0:C.token,O]),(0,h.useEffect)(()=>{C&&C.userId&&C.token&&!y.current&&(y.current=!0,T())},[null==C?void 0:C.userId,null==C?void 0:C.token,T]),(0,h.useEffect)(()=>{E&&E.success&&E.dataList&&(console.log("关注列表数据:",E.dataList),I(E.dataList))},[E]),(0,h.useEffect)(()=>{L&&L.success&&L.dataList&&(console.log("粉丝列表数据:",L.dataList),_(L.dataList))},[L]);let M=e=>{v(e),C&&C.userId&&C.token&&("following"===e?O():"follower"===e&&T())},F="following"===n?R:j;console.log("currentUsers:",F);let U="following"===n?S:P,D="following"===n?b:k;return(0,r.jsx)(u.a,{children:(0,r.jsxs)("main",{className:"flex min-h-dvh flex-col bg-white",children:[(0,r.jsx)(c.h,{showSearch:!0,showUser:!0}),(0,r.jsxs)("div",{className:"flex items-center justify-between px-4 py-4 z-100",children:[(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("button",{onClick:()=>M("following"),className:"text-lg font-semibold font-nunito px-6 rounded-full ".concat("following"===n?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-sm":"text-gray-500"),children:e("followedPage.following")}),(0,r.jsx)("button",{onClick:()=>M("follower"),className:"text-lg font-semibold font-nunito px-4 rounded-full ".concat("follower"===n?"bg-gradient-to-r from-orange-500 to-pink-500 text-white shadow-sm":"text-gray-500"),children:e("followedPage.follower")})]}),(0,r.jsx)("button",{onClick:()=>{t.back()},className:"text-[#0F1728] hover:text-[#0F1728] font-nunito",children:(0,r.jsx)(o.Z,{className:"h-7 w-7 z-10"})})]}),U&&(0,r.jsxs)("div",{className:(0,w.AK)("flex items-center justify-center",N.vR.SPACING.PY_8),children:[(0,r.jsx)(l.Z,{className:(0,w.AK)(N.vR.SIZES.ICON_MD,N.$w.SPIN,N.vR.COLORS.PRIMARY)}),(0,r.jsx)("span",{className:(0,w.AK)("ml-2 text-[#11295b]",N.vR.COLORS.PRIMARY,N.vR.FONTS.NUNITO),children:e("followedPage.loading")})]}),D&&(0,r.jsxs)("div",{className:(0,w.AK)("flex items-center justify-center",N.vR.SPACING.PY_8),children:[(0,r.jsx)(s.Z,{className:(0,w.AK)(N.vR.SIZES.ICON_MD,N.vR.COLORS.RED_500)}),(0,r.jsx)("span",{className:(0,w.AK)("ml-2 text-[#11295b]",N.vR.COLORS.RED_500,N.vR.FONTS.NUNITO),children:e("followedPage.error")})]}),!U&&!D&&0===F.length&&(0,r.jsxs)("div",{className:(0,w.AK)("flex flex-col items-center justify-center text-[#11295b]",N.vR.SPACING.PY_12),children:[(0,r.jsx)("div",{className:(0,w.AK)("w-16 h-16",N.vR.COLORS.GRAY_100,N.vR.BORDER_RADIUS.ROUNDED_FULL,"flex items-center justify-center",N.vR.SPACING.MB_4),children:(0,r.jsx)(s.Z,{className:(0,w.AK)(N.vR.SIZES.ICON_XL,N.vR.COLORS.GRAY_400)})}),(0,r.jsx)("h3",{className:(0,w.AK)("text-lg",N.vR.FONT_WEIGHTS.SEMIBOLD,N.vR.COLORS.PRIMARY,N.vR.FONTS.NUNITO,N.vR.SPACING.MB_2),children:e("following"===n?"followedPage.noFollowing":"followedPage.noFollowers")}),(0,r.jsx)("p",{className:(0,w.AK)(N.vR.COLORS.PRIMARY_OPACITY_60,N.vR.FONTS.INTER,"text-center text-[#11295b] px-4"),children:e("following"===n?"followedPage.noFollowingDescription":"followedPage.noFollowersDescription")})]}),!U&&!D&&F.length>0&&(0,r.jsx)("div",{className:"flex-1 px-4 py-4 space-y-4",children:F.map(e=>(0,r.jsxs)(d.default,{href:"/personal/".concat(e.userId),children:[(0,r.jsxs)("div",{className:"flex items-center gap-4 p-2 hover:bg-gray-50 rounded-lg",children:[(0,r.jsx)(f.default,{src:(0,p.nJ)(e.avatar),alt:e.nickname,width:48,height:48,className:"rounded-full w-10 h-10 object-cover"}),(0,r.jsx)("span",{className:"text-lg text-[#11295b] font-nunito",children:e.nickname})]}),(0,r.jsx)("div",{style:{borderBottom:"1px solid #e5e7eb"}})]},e.userId))}),(0,r.jsx)(a.$,{})]})})}},2690:function(e,t,n){"use strict";n.d(t,{a:function(){return d}});var r=n(7437),o=n(2265),l=n(9376),s=n(6281),i=n(759),c=n(8783);let a=["/","/square","/login","/register","/forgot-password","/change-password","/personalization","/about","/privacy"];function u(e){return a.some(t=>"/"===t?"/"===e:e.startsWith(t))}function d(e){let{children:t,fallback:n}=e,{isAuthenticated:a,authInfo:d}=(0,s.a)(),{t:f}=(0,i.Z)(),g=(0,l.useRouter)(),h=(0,l.usePathname)(),[x,m]=(0,o.useState)(!1);return((0,o.useEffect)(()=>{let e=setTimeout(()=>{m(!0)},100);return()=>clearTimeout(e)},[]),(0,o.useEffect)(()=>{if(!x){console.log("AuthGuard: Waiting for initialization...");return}if(console.log("AuthGuard useEffect triggered:",{pathname:h,search:window.location.search,isAuthenticated:a,hasAuthInfo:!!d,isPublic:u(h),isInitialized:x}),u(h)){console.log("Public path, no auth check needed");return}if(a&&(null==d?void 0:d.userId)&&(null==d?void 0:d.token))console.log("User is authenticated, allowing access");else{let e;if(console.log("User not authenticated, checking for redirect loop"),function(e,t){if(console.log("Checking for redirect loop:",{pathname:e,search:t}),e.startsWith("/login"))return console.log("Current path is login page, preventing redirect"),!0;let n=new URLSearchParams(t).get("redirect");if(n){console.log("Found redirect parameter:",n);try{let e=decodeURIComponent(n);if(console.log("Decoded redirect:",e),e.includes("/login"))return console.log("Redirect contains /login, preventing loop"),!0;if(e.includes("redirect="))return console.log("Redirect contains nested redirect parameter, preventing loop"),!0;if(e.includes("?"))return console.log("Redirect contains query parameters, preventing loop"),!0;if(e.includes("%2Flogin")||e.includes("%252Flogin"))return console.log("Redirect contains encoded login path, preventing loop"),!0}catch(e){return console.warn("Failed to decode redirect parameter:",n,e),!0}}return console.log("No redirect loop detected"),!1}(h,window.location.search)){console.warn("Prevented redirect loop to login page");return}if("/login"===h){console.warn("Already on login page, preventing redirect");return}window.location.search.includes("redirect=")?(e="/login",console.log("Existing redirect detected, using default login URL")):console.log("Redirecting to login:",e="/login?redirect=".concat(encodeURIComponent(h))),g.push(e)}},[a,d,h,g,x]),u(h))?(0,r.jsx)(r.Fragment,{children:t}):a&&(null==d?void 0:d.userId)&&(null==d?void 0:d.token)?(0,r.jsx)(r.Fragment,{children:t}):n||(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(c.TK,{size:"lg",text:f("common.verifying")})})})}},1839:function(e,t,n){"use strict";n.d(t,{$:function(){return c}});var r=n(7437),o=n(759),l=n(3145);function s(e){let{transparent:t=!1}=e,{language:n,setLanguage:s}=(0,o.Z)();return(0,r.jsxs)("button",{onClick:()=>{s("en"===n?"zh":"en")},className:"flex items-center ".concat(t?"text-white":"text-[#0F1728]"," hover:opacity-80 transition-opacity"),"aria-label":"Switch to ".concat("en"===n?"Chinese":"English"),children:[(0,r.jsx)(l.default,{src:t?"/img/lang.png":"/img/lang-d.png",alt:"Language",width:24,height:24,className:"h-4 w-4"}),(0,r.jsx)("span",{className:"text-[10px] font-medium ml-1 ".concat(t?"text-white":"text-[#0F1728]"),children:"en"===n?"EN":"CN"})]})}var i=n(7648);function c(e){let{transparent:t=!1}=e,{t:n}=(0,o.Z)();return(0,r.jsx)("footer",{className:"mt-auto text-[10px] py-4 px-4 w-full font-inter ".concat(t?"text-white":"text-[#0F1728]"),children:(0,r.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,r.jsx)("div",{className:"flex items-center gap-2 font-inter",children:(0,r.jsx)(s,{transparent:t})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[(0,r.jsx)(i.default,{href:"/about",className:"".concat(t?"text-white":"text-[#0F1728]"," font-inter"),children:n("footer.links.about")}),(0,r.jsx)(i.default,{href:"/privacy",className:"".concat(t?"text-white":"text-[#0F1728]"," font-inter"),children:n("footer.links.privacy")}),(0,r.jsx)("span",{className:"".concat(t?"text-white":"text-[#0F1728]"," font-inter"),children:n("footer.copyright")}),(0,r.jsx)(l.default,{src:t?"/img/logo-1.png":"/img/logo-2.png",alt:"Language",width:52,height:22,className:"h-5 w-auto"})]})]})})}},8783:function(e,t,n){"use strict";n.d(t,{TK:function(){return c},Te:function(){return a},ub:function(){return u}});var r=n(7437),o=n(2869),l=n(9322),s=n(7168),i=n(759);function c(e){let{size:t="md",text:n,className:o=""}=e,{t:l}=(0,i.Z)(),s=n||l("common.loading");return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(o),children:[(0,r.jsx)("div",{className:"animate-spin rounded-full border-b-2 border-[#11295b] ".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t]," mb-2")}),s&&(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:s})]})}function a(e){let{error:t,onRetry:n,retryText:c,className:a=""}=e,{t:u}=(0,i.Z)(),d=c||u("common.retry");return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(a),children:[(0,r.jsx)(l.Z,{className:"h-8 w-8 text-red-500 mb-2"}),(0,r.jsx)("p",{className:"text-red-500 mb-4 text-center",children:t}),n&&(0,r.jsxs)(o.z,{onClick:n,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,r.jsx)(s.Z,{className:"h-4 w-4"}),d]})]})}function u(e){let{title:t,description:n,icon:o,action:l,className:s=""}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center text-center ".concat(s),children:[o&&(0,r.jsx)("div",{className:"mb-4",children:o}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),n&&(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:n}),l&&(0,r.jsx)("div",{children:l})]})}},8685:function(e,t,n){"use strict";n.d(t,{$w:function(){return s},ZX:function(){return r},iK:function(){return l},vR:function(){return o}});let r={DEFAULT_PAGE:1,DEFAULT_LIMIT:999,MAX_LIMIT:100,REQUEST_TIMEOUT:1e4,MAX_RETRIES:3},o={COLORS:{PRIMARY:"#11295b",PRIMARY_OPACITY_80:"#11295b/80",PRIMARY_OPACITY_60:"#11295b/60",GRAY_100:"bg-gray-100",GRAY_400:"text-gray-400",RED_500:"text-red-500",WHITE:"text-white"},FONTS:{POPPINS:"font-poppins",NUNITO:"font-nunito",INTER:"font-inter"},FONT_WEIGHTS:{SEMIBOLD:"font-semibold",NORMAL:"font-normal"},SIZES:{ICON_SM:"h-3.5 w-3.5",ICON_MD:"h-6 w-6",ICON_LG:"h-7 w-7",ICON_XL:"h-8 w-8"},SPACING:{GAP_2:"gap-2",GAP_4:"gap-4",MB_2:"mb-2",MB_4:"mb-4",MB_6:"mb-6",MY_4:"my-4",PX_6:"px-6",PY_2:"py-2",PY_8:"py-8",PY_12:"py-12",PB_6:"pb-6"},BORDER_RADIUS:{ROUNDED_MD:"rounded-md",ROUNDED_FULL:"rounded-full"},EFFECTS:{OPACITY_50:"opacity-50",OPACITY_80:"/80",OPACITY_60:"/60"}},l={IMAGES:{MAX_THUMBNAILS:3,DEFAULT_IMAGE:"/img/band.png",THUMBNAIL_SIZE:{width:360,height:220},THUMBNAIL_CLASS:"w-full h-28 object-cover rounded-md"},LAYOUT:{GRID_COLS_3:"grid-cols-3",MIN_HEIGHT_DVH:"min-h-dvh",FLEX_COL:"flex-col",FLEX_CENTER:"flex items-center justify-center",FLEX_BETWEEN:"flex items-center justify-between"},TEXT_SIZES:{TITLE:"text-2xl",SUBTITLE:"text-lg",BODY:"text-[15px]",SMALL:"text-sm",XS:"text-xs"}},s={SPIN:"animate-spin",FADE_IN:"animate-fade-in",SLIDE_UP:"animate-slide-up"}},7471:function(e,t,n){"use strict";n.d(t,{h:function(){return s}});var r=n(2265),o=n(9376),l=n(6281);function s(e,t){let[n,s]=(0,r.useState)({data:null,loading:!1,error:null,success:!1}),i=(0,o.useSearchParams)(),{userParams:c}=(0,l.z)(),a=(0,r.useCallback)(()=>{if(c)return c;let e=i.get("userId"),t=i.get("token"),n=i.get("email");return e&&t?{userId:e,token:t,email:n||void 0}:null},[i,c]),u=(0,r.useCallback)(async n=>{let r=n||a();if(!r){t&&s({data:t,loading:!1,error:null,success:!0});return}s(e=>({...e,loading:!0,error:null}));try{let t=await e(r);s({data:t,loading:!1,error:null,success:!0})}catch(e){s({data:t||null,loading:!1,error:e instanceof Error?e.message:"请求失败",success:!1})}},[e,a,t]),d=(0,r.useCallback)(()=>{s({data:null,loading:!1,error:null,success:!1})},[]);return{...n,execute:u,reset:d,userParams:a()}}},6652:function(e,t,n){"use strict";n.d(t,{AK:function(){return o}});var r=n(4508);function o(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.cn)(...t.filter(Boolean))}},9205:function(e,t,n){"use strict";n.d(t,{Z:function(){return d}});var r=n(2265);let o=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),l=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),s=e=>{let t=l(e);return t.charAt(0).toUpperCase()+t.slice(1)},i=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()},c=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var a={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let u=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:o=24,strokeWidth:l=2,absoluteStrokeWidth:s,className:u="",children:d,iconNode:f,...g}=e;return(0,r.createElement)("svg",{ref:t,...a,width:o,height:o,stroke:n,strokeWidth:s?24*Number(l)/Number(o):l,className:i("lucide",u),...!d&&!c(g)&&{"aria-hidden":"true"},...g},[...f.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(d)?d:[d]])}),d=(e,t)=>{let n=(0,r.forwardRef)((n,l)=>{let{className:c,...a}=n;return(0,r.createElement)(u,{ref:l,iconNode:t,className:i("lucide-".concat(o(s(e))),"lucide-".concat(e),c),...a})});return n.displayName=s(e),n}},2451:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},9322:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},1817:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},7168:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},function(e){e.O(0,[604,51,624,971,117,744],function(){return e(e.s=8142)}),_N_E=e.O()}]);