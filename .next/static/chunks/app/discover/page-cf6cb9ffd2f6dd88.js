(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[583],{5822:function(e,t,n){Promise.resolve().then(n.bind(n,6140))},6140:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return d}});var r=n(7437),s=n(2869),i=n(3774);let c=(0,n(9205).Z)("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);var l=n(759),a=n(9512),o=n(2690);function d(){let{t:e}=(0,l.Z)();return(0,r.jsx)(o.a,{children:(0,r.jsxs)("main",{className:"container-page flex min-h-dvh flex-col",children:[(0,r.jsx)(a.h,{}),(0,r.jsx)("section",{className:"flex-1 mb-4",children:(0,r.jsx)("div",{className:"w-full h-64 rounded-2xl bg-card/60 flex items-center justify-center",children:(0,r.jsxs)("div",{className:"text-center text-muted-foreground",children:[(0,r.jsx)(i.Z,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),(0,r.jsx)("p",{children:e("discover.mapPlaceholder")})]})})}),(0,r.jsxs)("section",{className:"mb-6",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold text-white mb-3",children:e("discover.popularPlaces")}),(0,r.jsx)("div",{className:"space-y-3",children:["Istanbul","Tokyo","New York","Paris"].map(e=>(0,r.jsxs)("div",{className:"flex items-center justify-between p-3 rounded-xl bg-card/60",children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(i.Z,{className:"h-5 w-5 text-primary"}),(0,r.jsx)("span",{className:"text-white",children:e})]}),(0,r.jsx)(s.z,{variant:"ghost",size:"sm",children:(0,r.jsx)(c,{className:"h-4 w-4"})})]},e))})]}),(0,r.jsx)("footer",{className:"mt-auto text-center text-xs text-muted-foreground pb-3",children:e("discover.footer")})]})})}},2690:function(e,t,n){"use strict";n.d(t,{a:function(){return u}});var r=n(7437),s=n(2265),i=n(9376),c=n(6281),l=n(759),a=n(8783);let o=["/","/square","/login","/register","/forgot-password","/change-password","/personalization","/about","/privacy"];function d(e){return o.some(t=>"/"===t?"/"===e:e.startsWith(t))}function u(e){let{children:t,fallback:n}=e,{isAuthenticated:o,authInfo:u}=(0,c.a)(),{t:h}=(0,l.Z)(),f=(0,i.useRouter)(),x=(0,i.usePathname)(),[m,g]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{let e=setTimeout(()=>{g(!0)},100);return()=>clearTimeout(e)},[]),(0,s.useEffect)(()=>{if(!m){console.log("AuthGuard: Waiting for initialization...");return}if(console.log("AuthGuard useEffect triggered:",{pathname:x,search:window.location.search,isAuthenticated:o,hasAuthInfo:!!u,isPublic:d(x),isInitialized:m}),d(x)){console.log("Public path, no auth check needed");return}if(o&&(null==u?void 0:u.userId)&&(null==u?void 0:u.token))console.log("User is authenticated, allowing access");else{let e;if(console.log("User not authenticated, checking for redirect loop"),function(e,t){if(console.log("Checking for redirect loop:",{pathname:e,search:t}),e.startsWith("/login"))return console.log("Current path is login page, preventing redirect"),!0;let n=new URLSearchParams(t).get("redirect");if(n){console.log("Found redirect parameter:",n);try{let e=decodeURIComponent(n);if(console.log("Decoded redirect:",e),e.includes("/login"))return console.log("Redirect contains /login, preventing loop"),!0;if(e.includes("redirect="))return console.log("Redirect contains nested redirect parameter, preventing loop"),!0;if(e.includes("?"))return console.log("Redirect contains query parameters, preventing loop"),!0;if(e.includes("%2Flogin")||e.includes("%252Flogin"))return console.log("Redirect contains encoded login path, preventing loop"),!0}catch(e){return console.warn("Failed to decode redirect parameter:",n,e),!0}}return console.log("No redirect loop detected"),!1}(x,window.location.search)){console.warn("Prevented redirect loop to login page");return}if("/login"===x){console.warn("Already on login page, preventing redirect");return}window.location.search.includes("redirect=")?(e="/login",console.log("Existing redirect detected, using default login URL")):console.log("Redirecting to login:",e="/login?redirect=".concat(encodeURIComponent(x))),f.push(e)}},[o,u,x,f,m]),d(x))?(0,r.jsx)(r.Fragment,{children:t}):o&&(null==u?void 0:u.userId)&&(null==u?void 0:u.token)?(0,r.jsx)(r.Fragment,{children:t}):n||(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(a.TK,{size:"lg",text:h("common.verifying")})})})}},9512:function(e,t,n){"use strict";n.d(t,{h:function(){return x}});var r=n(7437),s=n(2869),i=n(3247),c=n(9862),l=n(759),a=n(9202);function o(e){let{transparent:t=!1}=e,{language:n,setLanguage:s}=(0,l.Z)();return(0,r.jsxs)("button",{onClick:()=>{s("en"===n?"zh":"en")},className:"flex items-center text-foreground hover:opacity-80 transition-opacity mt-2","aria-label":"Switch to ".concat("en"===n?"Chinese":"English"),children:[(0,r.jsx)(a.Z,{className:"h-5 w-5 ".concat(t?"text-white":"text-[#11295b]")}),(0,r.jsx)("span",{className:"text-sm font-medium ml-1 ".concat(t?"text-white":"text-[#11295b]"),children:"en"===n?"EN":"CN"})]})}var d=n(7648),u=n(3145),h=n(9376),f=n(6281);function x(e){let{showSearch:t=!1,showLanguage:n=!1,showUser:a=!1,className:x="",transparent:m=!1,logoLink:g="/",userLink:p="/login"}=e,{t:v}=(0,l.Z)(),j=(0,h.useRouter)(),{authInfo:y}=(0,f.a)();return(0,r.jsxs)("header",{className:"flex items-center justify-between py-3 w-full  ".concat(x),children:[(0,r.jsxs)("div",{className:"flex items-center gap-3",children:[(0,r.jsx)(d.default,{href:g,className:"flex items-center gap-2 ml-2",children:(0,r.jsx)(u.default,{src:m?"/img/logo-1.png":"/img/logo-2.png",alt:"logo",width:42,height:14,priority:!0,className:"h-14 w-42"})}),n?(0,r.jsx)(o,{transparent:m}):null]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[t?(0,r.jsx)(d.default,{href:"/search","aria-label":"search",children:(0,r.jsx)(s.z,{variant:"ghost",size:"icon",className:"text-foreground",children:(0,r.jsx)(i.Z,{className:"h-7 w-7 ".concat(m?"text-white":"text-[#11295b]")})})}):null,a?(0,r.jsx)(s.z,{variant:"ghost",size:"icon",className:"text-foreground",onClick:()=>{(null==y?void 0:y.token)&&(null==y?void 0:y.userId)?j.push("/personal-center"):j.push("/login")},"aria-label":"account",children:(0,r.jsx)(c.Z,{className:"h-7 w-7 ".concat(m?"text-white":"text-[#11295b]")})}):null]})]})}},8783:function(e,t,n){"use strict";n.d(t,{TK:function(){return a},Te:function(){return o},ub:function(){return d}});var r=n(7437),s=n(2869),i=n(9322),c=n(7168),l=n(759);function a(e){let{size:t="md",text:n,className:s=""}=e,{t:i}=(0,l.Z)(),c=n||i("common.loading");return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(s),children:[(0,r.jsx)("div",{className:"animate-spin rounded-full border-b-2 border-[#11295b] ".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t]," mb-2")}),c&&(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:c})]})}function o(e){let{error:t,onRetry:n,retryText:a,className:o=""}=e,{t:d}=(0,l.Z)(),u=a||d("common.retry");return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(o),children:[(0,r.jsx)(i.Z,{className:"h-8 w-8 text-red-500 mb-2"}),(0,r.jsx)("p",{className:"text-red-500 mb-4 text-center",children:t}),n&&(0,r.jsxs)(s.z,{onClick:n,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,r.jsx)(c.Z,{className:"h-4 w-4"}),u]})]})}function d(e){let{title:t,description:n,icon:s,action:i,className:c=""}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center text-center ".concat(c),children:[s&&(0,r.jsx)("div",{className:"mb-4",children:s}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),n&&(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:n}),i&&(0,r.jsx)("div",{children:i})]})}},2869:function(e,t,n){"use strict";n.d(t,{d:function(){return a},z:function(){return o}});var r=n(7437),s=n(2265),i=n(7053),c=n(535),l=n(4508);let a=(0,c.j)("inline-flex items-center justify-center whitespace-nowrap rounded-full text-sm font-medium transition-colors disabled:pointer-events-none disabled:opacity-50 btn-ring",{variants:{variant:{default:"bg-primary text-primary-foreground hover:opacity-90",outline:"border bg-transparent hover:bg-secondary/40",ghost:"hover:bg-secondary/50",gradient:"btn-gradient text-white"},size:{default:"h-11 px-5",sm:"h-9 px-4 text-xs",lg:"h-12 px-6 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),o=s.forwardRef((e,t)=>{let{className:n,variant:s,size:c,asChild:o=!1,...d}=e,u=o?i.g7:"button";return(0,r.jsx)(u,{ref:t,className:(0,l.cn)(a({variant:s,size:c}),n),...d})});o.displayName="Button"},4508:function(e,t,n){"use strict";n.d(t,{cn:function(){return i}});var r=n(3335),s=n(1994);function i(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return(0,r.m6)((0,s.Z)(t))}},9322:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3774:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},7168:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}},function(e){e.O(0,[516,51,971,117,744],function(){return e(e.s=5822)}),_N_E=e.O()}]);