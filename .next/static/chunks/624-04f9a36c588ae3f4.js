"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[624],{4196:function(t,e,r){r.d(e,{h:function(){return u}});var o=r(7437),n=r(2869),a=r(7648),s=r(3145),c=r(9376),i=r(6281);function u(t){let{showSearch:e=!1,showUser:r=!1,className:u="",transparent:l=!1,logoLink:d="/",userLink:f="/login"}=t,h=(0,c.useRouter)(),{authInfo:g}=(0,i.a)();return(0,o.jsxs)("header",{className:"flex items-center justify-between pt-3 px-1 w-full  ".concat(u),children:[(0,o.jsx)("div",{className:"flex items-center gap-4",children:(0,o.jsx)(a.default,{href:d,className:"flex items-center gap-2 ml-2",children:(0,o.jsx)(s.default,{src:l?"/img/logo-new-w.png":"/img/logo-new-d.png",alt:"logo",width:52,height:22,priority:!0,className:"h-14 w-auto"})})}),(0,o.jsxs)("div",{className:"flex items-center",children:[(0,o.jsx)(s.default,{src:"/img/bg.png",alt:"bg",width:16,height:16,className:"h-[14.5%] w-auto fixed top-0 right-0"}),e?(0,o.jsx)(a.default,{href:"/search","aria-label":"search",children:(0,o.jsx)(n.z,{variant:"ghost",size:"icon",className:"text-foreground",children:(0,o.jsx)(s.default,{src:"/img/search.png",alt:"search",width:28,height:28,className:"h-7 w-7 z-10"})})}):null,r?(0,o.jsx)(n.z,{variant:"ghost",size:"icon",className:"text-foreground",onClick:()=>{(null==g?void 0:g.token)&&(null==g?void 0:g.userId)?h.push("/personal-center"):h.push("/login")},"aria-label":"account",children:(0,o.jsx)(s.default,{src:l?"/img/user.png":"/img/user-d.png",alt:"search",width:28,height:28,className:"h-8 w-8 z-10"})}):null]})]})}},2869:function(t,e,r){r.d(e,{d:function(){return i},z:function(){return u}});var o=r(7437),n=r(2265),a=r(7053),s=r(535),c=r(4508);let i=(0,s.j)("inline-flex items-center justify-center whitespace-nowrap rounded-full text-sm font-medium transition-colors disabled:pointer-events-none disabled:opacity-50 btn-ring",{variants:{variant:{default:"bg-primary text-primary-foreground hover:opacity-90",outline:"border bg-transparent hover:bg-secondary/40",ghost:"hover:bg-secondary/50",gradient:"btn-gradient text-white"},size:{default:"h-11 px-5",sm:"h-9 px-4 text-xs",lg:"h-12 px-6 text-base",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),u=n.forwardRef((t,e)=>{let{className:r,variant:n,size:s,asChild:u=!1,...l}=t,d=u?a.g7:"button";return(0,o.jsx)(d,{ref:e,className:(0,c.cn)(i({variant:n,size:s}),r),...l})});u.displayName="Button"},9116:function(t,e,r){r.d(e,{Hz:function(){return a},bl:function(){return o},nJ:function(){return n}});let o={BASE_URL:"https://std.spinlinx.com",STATIC_URL:"https://std.spinlinx.com"},n=function(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/img/avatar.png";if(!t||""===t.trim())return e;if(t.startsWith("http"))try{return new URL(t),t}catch(t){return e}let r="".concat(o.STATIC_URL).concat(t);try{return new URL(r),r}catch(t){return e}},a={BASE_URL:"".concat(o.BASE_URL,"/homeapi.php"),UPLOAD_URL:"".concat(o.BASE_URL,"/upimg.php"),TIMEOUT:1e4,DEFAULT_HEADERS:{"Content-Type":"application/x-www-form-urlencoded",Accept:"application/json"},ENDPOINTS:{REGISTER:"register",LOGIN:"login",UPLOAD_IMG:"uploadimg"}}},6023:function(t,e,r){r.d(e,{$x:function(){return k},B$:function(){return T},I:function(){return f},Ir:function(){return L},NG:function(){return b},SX:function(){return g},V4:function(){return y},Yt:function(){return l},_Z:function(){return I},a$:function(){return a},aw:function(){return A},bG:function(){return u},c0:function(){return i},gF:function(){return c},gQ:function(){return E},gS:function(){return d},gg:function(){return v},h5:function(){return h},jX:function(){return S},mG:function(){return m},pH:function(){return s},u9:function(){return N},v1:function(){return p},w:function(){return w},wo:function(){return x}});var o=r(8806),n=r(9116);async function a(t){try{return await (0,o.WY)("register",{email:t.email,password:t.password,language:t.language,acceptTerms:t.acceptTerms,location:t.location})}catch(t){if(t instanceof o.Lu)throw Error("注册失败: ".concat(t.message));throw Error("注册过程中发生未知错误")}}async function s(t,e){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en";try{return await (0,o.WY)("login",{email:t,password:e,language:r})}catch(t){if(t instanceof o.Lu)throw Error("登录失败: ".concat(t.message));throw Error("登录过程中发生未知错误")}}async function c(t){try{return await (0,o.WY)("forgot-password",{email:t})}catch(t){if(t instanceof o.Lu)throw Error("发送重置邮件失败: ".concat(t.message));throw Error("发送重置邮件过程中发生未知错误")}}async function i(t,e,r,n){try{return await (0,o.WY)("reset-password",{email:t,newPassword:e,userId:r,token:n})}catch(t){if(t instanceof o.Lu)throw Error("重置密码失败: ".concat(t.message));throw Error("重置密码过程中发生未知错误")}}async function u(t){try{return await (0,o.WY)("getuserinfo",{email:t.email,userId:t.userId,token:t.token})}catch(t){if(t instanceof o.Lu)throw Error("获取用户信息失败: ".concat(t.message));throw Error("获取用户信息过程中发生未知错误")}}async function l(t){try{return await (0,o.WY)("getothersmassage",{userId:t.userId,token:t.token,otherId:t.otherId})}catch(t){if(t instanceof o.Lu)throw Error("获取其他用户信息失败: ".concat(t.message));throw Error("获取其他用户信息过程中发生未知错误")}}async function d(t,e,r,n,a){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"en";try{return await (0,o.WY)("userprofile",{email:t,userId:e,token:r,nickname:n,avatar:a||"",language:s})}catch(t){if(t instanceof o.Lu)throw Error("更新用户信息失败: ".concat(t.message));throw Error("更新用户信息过程中发生未知错误")}}async function f(t){try{return await (0,o.WY)("updateuserbrand",{email:t.email,userId:t.userId,token:t.token,brand:t.brand||"",brief:t.brief||"",logo:t.logo||"",officialsite:t.officialsite||"",tel:t.tel||"",address:t.address||"",location:t.location||"",workHour:t.workHour||"",shopurl:t.shopurl||""})}catch(t){if(t instanceof o.Lu)throw Error("更新品牌信息失败: ".concat(t.message));throw Error("更新品牌信息过程中发生未知错误")}}async function h(t){try{return await (0,o.WY)("postsquare",{userId:t.userId,token:t.token,title:t.title,description:t.description,location:t.location,images:t.images||"",video:t.video||"",website:t.website||"",logo:t.logo||"",intro:t.intro||"",operatingHours:t.operatingHours||"",customerService:t.customerService||"",workingHours:t.workingHours||""})}catch(t){if(t instanceof o.Lu)throw Error("发布广场内容失败: ".concat(t.message));throw Error("发布广场内容过程中发生未知错误")}}async function g(t){try{let e={tab:t.tab||"",page:t.page||1,limit:t.limit||10,location:t.location};return t.userId&&t.token&&(e.userId=t.userId,e.token=t.token),await (0,o.WY)("gethomelist",e)}catch(t){if(t instanceof o.Lu)throw Error("获取广场内容列表失败: ".concat(t.message));throw Error("获取广场内容列表过程中发生未知错误")}}async function m(t){try{let e=await (0,o.WY)("getdetail",{userId:t.userId,token:t.token,postId:t.postId});return e.success&&e.data&&(Array.isArray(e.comments)?e.data.comments=e.comments:Array.isArray(e.data.comments)||(e.data.comments=[])),e}catch(t){if(t instanceof o.Lu)throw Error("获取广场内容详情失败: ".concat(t.message));throw Error("获取广场内容详情过程中发生未知错误")}}async function w(t){try{return await (0,o.WY)("postcomments",{userId:t.userId,token:t.token,productId:t.productId,parentId:t.parentId||"",content:t.content})}catch(t){if(t instanceof o.Lu)throw Error("发表评论失败: ".concat(t.message));throw Error("发表评论过程中发生未知错误")}}async function p(t){try{return await (0,o.WY)("loveinformation",{userId:t.userId,token:t.token,productId:t.productId,isLove:t.isLove})}catch(t){if(t instanceof o.Lu)throw Error("点赞操作失败: ".concat(t.message));throw Error("点赞操作过程中发生未知错误")}}async function E(t){try{return await (0,o.WY)("collectinformation",{userId:t.userId,token:t.token,productId:t.productId,isCollect:t.isCollect})}catch(t){if(t instanceof o.Lu)throw Error("收藏操作失败: ".concat(t.message));throw Error("收藏操作过程中发生未知错误")}}async function y(t){try{return await (0,o.WY)("collectuser",{userId:t.userId,token:t.token,authorId:t.authorId,isCollect:t.isCollect})}catch(t){if(t instanceof o.Lu)throw Error("关注操作失败: ".concat(t.message));throw Error("关注操作过程中发生未知错误")}}async function I(t){try{return await (0,o.WY)("shareinformation",{userId:t.userId,token:t.token,productId:t.productId})}catch(t){if(t instanceof o.Lu)throw Error("分享操作失败: ".concat(t.message));throw Error("分享操作过程中发生未知错误")}}async function v(t){try{let e;if(t.size>10485760)throw Error("图片文件过大，请选择小于10MB的文件。当前文件大小: ".concat((t.size/1024/1024).toFixed(2),"MB"));console.log("Image file size: ".concat((t.size/1024/1024).toFixed(2),"MB")),console.log("Image file type: ".concat(t.type));let r=await new Promise((e,r)=>{let o=new FileReader;o.onload=()=>{e(o.result)},o.onerror=()=>r(Error("文件读取失败")),o.readAsDataURL(t)}),a="".concat(n.Hz.UPLOAD_URL,"?action=uploadimg");console.log("Image upload URL: ".concat(a)),console.log("Base64 data length: ".concat(r.length));let s=new FormData;s.append("avatar",r);let c=new AbortController,i=setTimeout(()=>c.abort(),6e4),u=await fetch(a,{method:"POST",body:s,signal:c.signal});if(clearTimeout(i),!u.ok)throw new o.Lu("HTTP Error: ".concat(u.status," ").concat(u.statusText),u.status);let l=await u.text();if(console.log("Image upload response status: ".concat(u.status)),console.log("Image upload response text: ".concat(l)),!l.trim())throw new o.Lu("Empty response from image upload server",u.status);try{e=JSON.parse(l),console.log("Successfully parsed image upload JSON response:",e)}catch(t){console.log("Failed to parse JSON, treating as text response"),e={img:l.trim()}}if(e.error||void 0!==e.code&&0!==e.code||!1===e.success)throw new o.Lu(e.message||e.error||"Image upload failed",u.status,e.code);return{success:!0,data:e.data||e,message:e.message,code:e.code}}catch(t){if(console.error("Image upload error:",t),t instanceof o.Lu)throw Error("图片上传失败: ".concat(t.message));throw Error("图片上传过程中发生未知错误")}}async function k(t){try{let e;if(t.size>209715200)throw Error("视频文件过大，请选择小于200MB的文件。当前文件大小: ".concat((t.size/1024/1024).toFixed(2),"MB"));console.log("Video file size: ".concat((t.size/1024/1024).toFixed(2),"MB")),console.log("Video file type: ".concat(t.type));let r=n.Hz.UPLOAD_URL.replace("/upimg.php","/videoyasuo.php"),a="".concat(r,"?action=pushvideo");console.log("Video upload URL: ".concat(a));let s=new FormData;s.append("video",t);let c=new AbortController,i=setTimeout(()=>c.abort(),3e5),u=await fetch(a,{method:"POST",body:s,signal:c.signal});if(clearTimeout(i),!u.ok)throw new o.Lu("HTTP Error: ".concat(u.status," ").concat(u.statusText),u.status);let l=await u.text();if(console.log("Video upload response status: ".concat(u.status)),console.log("Video upload response text length: ".concat(l.length)),console.log("Video upload response text: ".concat(l)),!l.trim())return console.log("Empty response from video upload server, treating as success"),{success:!0,data:{url:"upload_success",code:0,msg:"ok"},message:"Video uploaded successfully",code:0};try{e=JSON.parse(l),console.log("Successfully parsed video upload JSON response:",e)}catch(t){console.log("Failed to parse JSON, treating as text response"),e={img:l.trim()}}if(e.error||void 0!==e.code&&0!==e.code||!1===e.success)throw new o.Lu(e.message||e.error||"Video upload failed",u.status,e.code);return{success:!0,data:e.data||e,message:e.message,code:e.code}}catch(t){if(t instanceof o.Lu)throw Error("视频上传失败: ".concat(t.message));throw Error("视频上传过程中发生未知错误")}}async function L(t){try{return await (0,o.WY)("collectuserlist",{userId:t.userId,token:t.token})}catch(t){if(t instanceof o.Lu)throw Error("获取关注列表失败: ".concat(t.message));throw Error("获取关注列表过程中发生未知错误")}}async function x(t){try{return await (0,o.WY)("collectmylist",{userId:t.userId,token:t.token})}catch(t){if(t instanceof o.Lu)throw Error("获取粉丝列表失败: ".concat(t.message));throw Error("获取粉丝列表过程中发生未知错误")}}async function b(t){try{return await (0,o.WY)("getbrowsinglist",{userId:t.userId,token:t.token,page:t.page||1,limit:t.limit||10})}catch(t){if(t instanceof o.Lu)throw Error("获取浏览记录失败: ".concat(t.message));throw Error("获取浏览记录过程中发生未知错误")}}async function T(t){try{return await (0,o.WY)("getcollectlist",{userId:t.userId,token:t.token,page:t.page||1,limit:t.limit||10})}catch(t){if(t instanceof o.Lu)throw Error("获取收藏列表失败: ".concat(t.message));throw Error("获取收藏列表过程中发生未知错误")}}async function S(t){try{return await (0,o.WY)("userArticleDel",{userId:t.userId,token:t.token,id:t.id})}catch(t){if(t instanceof o.Lu)throw Error("删除作品失败: ".concat(t.message));throw Error("删除作品过程中发生未知错误")}}async function A(t){try{return await (0,o.WY)("userArticleHide",{userId:t.userId,token:t.token,id:t.id,status:t.status})}catch(t){if(t instanceof o.Lu)throw Error("隐藏作品失败: ".concat(t.message));throw Error("隐藏作品过程中发生未知错误")}}async function N(t){try{var e;let r=await (0,o.WY)("queryall",{userId:t.userId,token:t.token,typeid:t.typeid,title:t.title});if(console.log("Search API response:",r),!r.success&&(null===(e=r.message)||void 0===e?void 0:e.includes("token失效")))throw Error("TOKEN_EXPIRED");return r}catch(t){if(console.error("Search API error:",t),t instanceof o.Lu){if(t.message.includes("token失效")||t.message.includes("TOKEN_EXPIRED"))throw Error("TOKEN_EXPIRED");throw Error("搜索失败: ".concat(t.message))}throw Error("搜索过程中发生未知错误")}}},8806:function(t,e,r){r.d(e,{Lu:function(){return a},WY:function(){return s}});var o=r(9116);function n(t){var e,r,o,n,a;if(401===t.status||401===t.code||(null===(e=t.message)||void 0===e?void 0:e.includes("token"))||(null===(r=t.message)||void 0===r?void 0:r.includes("unauthorized"))||(null===(o=t.message)||void 0===o?void 0:o.includes("authentication"))||(null===(n=t.message)||void 0===n?void 0:n.includes("Token"))||(null===(a=t.message)||void 0===a?void 0:a.includes("Unauthorized"))){console.log("Authentication error detected:",t),localStorage.removeItem("auth_info"),document.cookie="auth_info=;expires=Thu, 01 Jan 1970 00:00:00 UTC;path=/;";{let t=window.location.pathname,e=window.location.search;t.startsWith("/login")||e.includes("redirect=")}}}class a extends Error{constructor(t,e,r){super(t),this.status=e,this.code=r,this.name="RequestError"}}async function s(t){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{let s="gethomelist"===t&&"recommend"===e.tab;if(["getuserinfo","postsquare","gethomelist","postcomments","loveinformation","collectinformation","collectuser","userprofile"].includes(t)&&!s&&!function(){try{let t=localStorage.getItem("auth_info");if(!t)return!1;let e=JSON.parse(t);return!!(e.userId&&e.token&&e.email)}catch(t){return console.warn("Failed to parse auth info:",t),!1}}())throw n({status:401,message:"No valid authentication token"}),new a("Authentication required",401);let c=function(t){let e=new URLSearchParams;return Object.entries(t).forEach(t=>{let[r,o]=t;null!=o&&e.append(r,String(o))}),e.toString()}({action:t,...e}),i="".concat(o.Hz.BASE_URL,"?").concat(c),u={method:"GET",headers:{...o.Hz.DEFAULT_HEADERS,...r.headers},...r},l=new AbortController,d=setTimeout(()=>l.abort(),o.Hz.TIMEOUT),f=await fetch(i,{...u,signal:l.signal});if(clearTimeout(d),!f.ok)throw new a("HTTP Error: ".concat(f.status," ").concat(f.statusText),f.status);let h=await f.json();if(h.error||void 0!==h.code&&0!==h.code||!1===h.success)throw new a(h.message||h.error||"Unknown error",f.status,h.code);return h}catch(e){if(e instanceof a)throw n(e),e;if(e instanceof Error){if("AbortError"===e.name)throw new a("Request timeout",408);let t=new a(e.message,0);throw n(t),t}let t=new a("Unknown error occurred",0);throw n(t),t}}},4508:function(t,e,r){r.d(e,{cn:function(){return a}});var o=r(3335),n=r(1994);function a(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];return(0,o.m6)((0,n.Z)(e))}}}]);