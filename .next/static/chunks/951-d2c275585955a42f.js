"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[951],{2690:function(e,t,n){n.d(t,{a:function(){return u}});var r=n(7437),i=n(2265),c=n(9376),o=n(6281),l=n(759),a=n(8783);let s=["/","/square","/login","/register","/forgot-password","/change-password","/personalization","/about","/privacy"];function d(e){return s.some(t=>"/"===t?"/"===e:e.startsWith(t))}function u(e){let{children:t,fallback:n}=e,{isAuthenticated:s,authInfo:u}=(0,o.a)(),{t:f}=(0,l.Z)(),h=(0,c.useRouter)(),g=(0,c.usePathname)(),[m,x]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{let e=setTimeout(()=>{x(!0)},100);return()=>clearTimeout(e)},[]),(0,i.useEffect)(()=>{if(!m){console.log("AuthGuard: Waiting for initialization...");return}if(console.log("AuthGuard useEffect triggered:",{pathname:g,search:window.location.search,isAuthenticated:s,hasAuthInfo:!!u,isPublic:d(g),isInitialized:m}),d(g)){console.log("Public path, no auth check needed");return}if(s&&(null==u?void 0:u.userId)&&(null==u?void 0:u.token))console.log("User is authenticated, allowing access");else{let e;if(console.log("User not authenticated, checking for redirect loop"),function(e,t){if(console.log("Checking for redirect loop:",{pathname:e,search:t}),e.startsWith("/login"))return console.log("Current path is login page, preventing redirect"),!0;let n=new URLSearchParams(t).get("redirect");if(n){console.log("Found redirect parameter:",n);try{let e=decodeURIComponent(n);if(console.log("Decoded redirect:",e),e.includes("/login"))return console.log("Redirect contains /login, preventing loop"),!0;if(e.includes("redirect="))return console.log("Redirect contains nested redirect parameter, preventing loop"),!0;if(e.includes("?"))return console.log("Redirect contains query parameters, preventing loop"),!0;if(e.includes("%2Flogin")||e.includes("%252Flogin"))return console.log("Redirect contains encoded login path, preventing loop"),!0}catch(e){return console.warn("Failed to decode redirect parameter:",n,e),!0}}return console.log("No redirect loop detected"),!1}(g,window.location.search)){console.warn("Prevented redirect loop to login page");return}if("/login"===g){console.warn("Already on login page, preventing redirect");return}window.location.search.includes("redirect=")?(e="/login",console.log("Existing redirect detected, using default login URL")):console.log("Redirecting to login:",e="/login?redirect=".concat(encodeURIComponent(g))),h.push(e)}},[s,u,g,h,m]),d(g))?(0,r.jsx)(r.Fragment,{children:t}):s&&(null==u?void 0:u.userId)&&(null==u?void 0:u.token)?(0,r.jsx)(r.Fragment,{children:t}):n||(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-white",children:(0,r.jsx)("div",{className:"text-center",children:(0,r.jsx)(a.TK,{size:"lg",text:f("common.verifying")})})})}},1839:function(e,t,n){n.d(t,{$:function(){return a}});var r=n(7437),i=n(759),c=n(3145);function o(e){let{transparent:t=!1}=e,{language:n,setLanguage:o}=(0,i.Z)();return(0,r.jsxs)("button",{onClick:()=>{o("en"===n?"zh":"en")},className:"flex items-center ".concat(t?"text-white":"text-[#0F1728]"," hover:opacity-80 transition-opacity"),"aria-label":"Switch to ".concat("en"===n?"Chinese":"English"),children:[(0,r.jsx)(c.default,{src:t?"/img/lang.png":"/img/lang-d.png",alt:"Language",width:24,height:24,className:"h-4 w-4"}),(0,r.jsx)("span",{className:"text-[10px] font-medium ml-1 ".concat(t?"text-white":"text-[#0F1728]"),children:"en"===n?"EN":"CN"})]})}var l=n(7648);function a(e){let{transparent:t=!1}=e,{t:n}=(0,i.Z)();return(0,r.jsx)("footer",{className:"mt-auto text-[10px] py-4 px-4 w-full font-inter ".concat(t?"text-white":"text-[#0F1728]"),children:(0,r.jsxs)("div",{className:"flex justify-between items-center w-full",children:[(0,r.jsx)("div",{className:"flex items-center gap-2 font-inter",children:(0,r.jsx)(o,{transparent:t})}),(0,r.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap",children:[(0,r.jsx)(l.default,{href:"/about",className:"".concat(t?"text-white":"text-[#0F1728]"," font-inter"),children:n("footer.links.about")}),(0,r.jsx)(l.default,{href:"/privacy",className:"".concat(t?"text-white":"text-[#0F1728]"," font-inter"),children:n("footer.links.privacy")}),(0,r.jsx)("span",{className:"".concat(t?"text-white":"text-[#0F1728]"," font-inter"),children:n("footer.copyright")}),(0,r.jsx)(c.default,{src:t?"/img/logo-1.png":"/img/logo-2.png",alt:"Language",width:52,height:22,className:"h-5 w-auto"})]})]})})}},8783:function(e,t,n){n.d(t,{TK:function(){return a},Te:function(){return s},ub:function(){return d}});var r=n(7437),i=n(2869),c=n(9322),o=n(7168),l=n(759);function a(e){let{size:t="md",text:n,className:i=""}=e,{t:c}=(0,l.Z)(),o=n||c("common.loading");return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(i),children:[(0,r.jsx)("div",{className:"animate-spin rounded-full border-b-2 border-[#11295b] ".concat({sm:"h-4 w-4",md:"h-8 w-8",lg:"h-12 w-12"}[t]," mb-2")}),o&&(0,r.jsx)("p",{className:"text-gray-500 text-sm",children:o})]})}function s(e){let{error:t,onRetry:n,retryText:a,className:s=""}=e,{t:d}=(0,l.Z)(),u=a||d("common.retry");return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center ".concat(s),children:[(0,r.jsx)(c.Z,{className:"h-8 w-8 text-red-500 mb-2"}),(0,r.jsx)("p",{className:"text-red-500 mb-4 text-center",children:t}),n&&(0,r.jsxs)(i.z,{onClick:n,variant:"outline",size:"sm",className:"flex items-center gap-2",children:[(0,r.jsx)(o.Z,{className:"h-4 w-4"}),u]})]})}function d(e){let{title:t,description:n,icon:i,action:c,className:o=""}=e;return(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center text-center ".concat(o),children:[i&&(0,r.jsx)("div",{className:"mb-4",children:i}),(0,r.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:t}),n&&(0,r.jsx)("p",{className:"text-gray-500 mb-4",children:n}),c&&(0,r.jsx)("div",{children:c})]})}},9205:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(2265);let i=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),c=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase()),o=e=>{let t=c(e);return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim()},a=e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0};var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let d=(0,r.forwardRef)((e,t)=>{let{color:n="currentColor",size:i=24,strokeWidth:c=2,absoluteStrokeWidth:o,className:d="",children:u,iconNode:f,...h}=e;return(0,r.createElement)("svg",{ref:t,...s,width:i,height:i,stroke:n,strokeWidth:o?24*Number(c)/Number(i):c,className:l("lucide",d),...!u&&!a(h)&&{"aria-hidden":"true"},...h},[...f.map(e=>{let[t,n]=e;return(0,r.createElement)(t,n)}),...Array.isArray(u)?u:[u]])}),u=(e,t)=>{let n=(0,r.forwardRef)((n,c)=>{let{className:a,...s}=n;return(0,r.createElement)(d,{ref:c,iconNode:t,className:l("lucide-".concat(i(o(e))),"lucide-".concat(e),a),...s})});return n.displayName=o(e),n}},3581:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]])},2451:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("chevron-left",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]])},9322:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("circle-alert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},3774:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("map-pin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},7168:function(e,t,n){n.d(t,{Z:function(){return r}});let r=(0,n(9205).Z)("refresh-cw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])}}]);